title: XCel é¡¹ç›®æ€»ç»“ - Electron ä¸ Vue çš„æ€§èƒ½ä¼˜åŒ–
subtitle: XCel æ˜¯ä¸€æ¬¾åŸºäºç”¨ç ”ç»„éœ€æ±‚çš„ Excel æ•°æ®è¿‡æ»¤å·¥å…·ï¼Œæœ¬æ–‡å°†åˆ†äº« Electronã€Vue ç­‰ç›¸å…³æ¶‰åŠæŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯†å’Œæ€§èƒ½ä¼˜åŒ–ç»éªŒã€‚è¿™ä¹Ÿè®¸æ˜¯Jcçš„2016å¹´æœ€åä¸€ç¯‡æ–‡ç« ï¼Œä¸”çœ‹ä¸”ä¸çæƒœã€‚
cover: //misc.aotu.io/JChehe/2016-11-15-xcel/poster.jpg
categories: é¡¹ç›®æ€»ç»“
tags:
  - excel
  - data-clening
  - electron
  - node
  - js-xlsx
  - vue
  
author:
  nick: Jc
  github_name: JChehe
coeditor:
    name: Jc
    url: https://github.com/JChehe
wechat:
    share_cover: https://misc.aotu.io/JChehe/2016-11-15-xcel/wx_share.jpg
    share_title: XCel é¡¹ç›®æ€»ç»“ - Electron ä¸ Vue çš„æ€§èƒ½ä¼˜åŒ–
    share_desc: æœ¬æ–‡å°†åˆ†äº« Electronã€Vue ç­‰ç›¸å…³æ¶‰åŠæŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯†å’Œæ€§èƒ½ä¼˜åŒ–ç»éªŒã€‚è¿™ä¹Ÿè®¸æ˜¯Jcçš„2016å¹´æœ€åä¸€ç¯‡æ–‡ç« ï¼Œä¸”çœ‹ä¸”ä¸çæƒœã€‚
date: 2016-11-15 23:23:23

---

XCEL æ˜¯ç”±äº¬ä¸œç”¨æˆ·ä½“éªŒè®¾è®¡éƒ¨å‡¹å‡¸å®éªŒå®¤æ¨å‡ºçš„ä¸€ä¸ª Excel æ•°æ®æ¸…æ´—å·¥å…·ï¼Œå…¶é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼è®©ç”¨æˆ·è½»æ¾åœ°å¯¹ Excel æ•°æ®è¿›è¡Œç­›é€‰ã€‚

XCEL åŸºäº Electron å’Œ Vue 2.xï¼Œå®ƒä¸ä»…è·¨å¹³å°ï¼ˆwindows 7+ã€Mac å’Œ Linuxï¼‰ï¼Œè€Œä¸”å……åˆ†åˆ©ç”¨ Electron å¤šè¿›ç¨‹ä»»åŠ¡å¤„ç†ç­‰åŠŸèƒ½ï¼Œä½¿å…¶æ€§èƒ½ä¼˜å¼‚ã€‚

è½åœ°é¡µï¼šhttps://xcel.aotu.io/   âœ¨âœ¨âœ¨  
é¡¹ç›®åœ°å€ï¼šhttps://github.com/o2team/xcel   âœ¨âœ¨âœ¨  


## é¡¹ç›®èƒŒæ™¯
ç”¨æˆ·ç ”ç©¶çš„å®šé‡ç ”ç©¶å’Œè½»é‡çº§æ•°æ®å¤„ç†ä¸­ï¼Œå‡éœ€å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å¤„ç†ï¼Œä»¥å‰”é™¤å¼‚å¸¸æ•°æ®ï¼Œä¿è¯æ•°æ®ç»“æœçš„ä¿¡åº¦å’Œæ•ˆåº¦ã€‚ç›®å‰å› è°ƒç ”æ•°æ®å’Œè½»é‡çº§æ•°æ®çš„å¤šå˜æ€§ï¼Œå¯¹è½»é‡çº§æ•°æ®æ¸…æ´—å¾€å¾€é‡‡å–äººå·¥æ¸…æ´—ï¼Œç¼ºå°‘ç»Ÿä¸€ã€æ ‡å‡†çš„æ¸…æ´—æµç¨‹ï¼Œä½†å¯¹äºè°ƒç ”å’Œè½»é‡çº§çš„æ•°æ®å¾€å¾€æ˜¯éœ€è¦ä¿è¯æ•°æ®ç¨³å®šæ€§çš„ï¼Œå› æ­¤ï¼Œåœ¨å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—æ—¶æœ€å¥½æœ‰æ ‡å‡†åŒ–çš„æ¸…æ´—æ–¹å¼ã€‚

## ç‰¹æ€§ä¸€è§ˆ

 - åŸºäº Electron ç ”å‘å¹¶æ‰“åŒ…æˆä¸ºåŸç”Ÿåº”ç”¨ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½ï¼›
 - å¯è§†åŒ–æ“ä½œ Excel æ•°æ®ï¼Œæ”¯æŒæ–‡ä»¶çš„å¯¼å…¥å¯¼å‡ºï¼›
 - æ‹¥æœ‰å•åˆ—è¿ç®—é€»è¾‘ã€å¤šåˆ—è¿ç®—é€»è¾‘å’ŒåŒåˆ—èŒƒå›´é€»è¾‘ä¸‰ç§ç­›é€‰æ–¹å¼ï¼Œå¹¶ä¸”å¯é€šè¿‡â€œä¸”â€ã€â€œæˆ–â€å’Œâ€œç¼–ç»„â€çš„æ–¹å¼ä»»æ„ç»„åˆã€‚

## æ€è·¯ä¸å®ç° 
åŸºäºç”¨ç ”ç»„çš„éœ€æ±‚ï¼Œåˆ©ç”¨ Electron å’Œ Vue çš„ç‰¹æ€§å¯¹è¯¥å·¥å…·è¿›è¡Œå¼€å‘ã€‚

### æŠ€æœ¯é€‰å‹

 - Electronï¼šæ¡Œé¢ç«¯è·¨å¹³å°æ¡†æ¶ï¼Œä¸º Web æä¾›äº†åŸç”Ÿæ¥å£çš„æƒé™ã€‚æ‰“åŒ…åçš„ç¨‹åºå…¼å®¹ Windows 7 åŠä»¥ä¸Šã€Macã€Linux çš„ 32 / 64 ä½ç³»ç»Ÿã€‚[è¯¦æƒ…>>][1]
 - Vue å…¨å®¶æ¡¶ï¼šVue æ‹¥æœ‰æ•°æ®é©±åŠ¨è§†å›¾çš„ç‰¹æ€§ï¼Œé€‚åˆé‡æ•°æ®äº¤äº’çš„åº”ç”¨ã€‚[è¯¦æƒ…>>][2]
 - js-xlsxï¼šå…¼å®¹å„ç§ç”µå­è¡¨æ ¼æ ¼å¼çš„è§£æå™¨å’Œç”Ÿæˆå™¨ã€‚çº¯ JavaScript å®ç°ï¼Œé€‚ç”¨äº Node.js å’Œ Web å‰ç«¯ã€‚[è¯¦æƒ…>>][3]

### å®ç°æ€è·¯

1. é€šè¿‡ js-xlsx å°† Excel æ–‡ä»¶è§£æä¸º JSON æ•°æ®  
2. æ ¹æ®ç­›é€‰æ¡ä»¶å¯¹ JSON æ•°æ®è¿›è¡Œç­›é€‰è¿‡æ»¤  
3. å°†è¿‡æ»¤åçš„ JSON æ•°æ®è½¬æ¢æˆ js-xlsx æŒ‡å®šçš„æ•°æ®ç»“æ„  
4. åˆ©ç”¨ js-xlsx å¯¹è½¬æ¢åçš„æ•°æ®ç”Ÿæˆ Excel æ–‡ä»¶  

-----

**çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ**

## ç›¸å…³æŠ€æœ¯
å¦‚æœå¯¹æŸé¡¹æŠ€æœ¯æ¯”è¾ƒç†Ÿæ‚‰ï¼Œåˆ™å¯ç•¥è¯»/è·³è¿‡ã€‚

### Electron
#### Electron æ˜¯ä»€ä¹ˆï¼Ÿ
Electron æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ **JavaScriptã€HTML å’Œ CSS** æ„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºçš„**åº“**ã€‚è¿™äº›åº”ç”¨ç¨‹åºèƒ½æ‰“åŒ…åˆ° Macã€Windows å’Œ Linux ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¹Ÿèƒ½ä¸Šæ¶åˆ° Mac å’Œ Windows çš„ App Storeã€‚

 - **JavaScriptã€HTML å’Œ CSS** éƒ½æ˜¯ Web è¯­è¨€ï¼Œå®ƒä»¬æ˜¯ç»„æˆç½‘ç«™çš„ä¸€éƒ¨åˆ†ï¼Œæµè§ˆå™¨ï¼ˆå¦‚ Chromeï¼‰æ‡‚å¾—å¦‚ä½•å°†è¿™äº›ä»£ç è½¬ä¸ºå¯è§†åŒ–å›¾åƒã€‚
 - **Electron æ˜¯ä¸€ä¸ªåº“**ï¼šElectron å¯¹åº•å±‚ä»£ç è¿›è¡ŒæŠ½è±¡å’Œå°è£…ï¼Œè®©å¼€å‘è€…èƒ½åœ¨æ­¤ä¹‹ä¸Šæ„å»ºé¡¹ç›®ã€‚

#### ä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤é‡è¦ï¼Ÿ
é€šå¸¸æ¥è¯´ï¼Œæ¯ä¸ªæ“ä½œç³»ç»Ÿçš„æ¡Œé¢åº”ç”¨éƒ½ç”±å„è‡ªçš„åŸç”Ÿè¯­è¨€è¿›è¡Œç¼–å†™ï¼Œè¿™æ„å‘³ç€éœ€è¦ 3 ä¸ªå›¢é˜Ÿåˆ†åˆ«ä¸ºè¯¥åº”ç”¨ç¼–å†™ç›¸åº”ç‰ˆæœ¬ã€‚è€Œ Electron åˆ™å…è®¸ä½ ç”¨ Web è¯­è¨€ç¼–å†™ä¸€æ¬¡å³å¯ã€‚

- **åŸç”Ÿï¼ˆæ“ä½œç³»ç»Ÿï¼‰è¯­è¨€**ï¼šç”¨äºå¼€å‘ä¸»æµæ“ä½œç³»ç»Ÿåº”ç”¨çš„åŸç”Ÿè¯­è¨€çš„å¯¹åº”å…³ç³»ï¼ˆå¤§å¤šæ•°æƒ…å†µä¸‹ï¼‰ï¼šMac å¯¹åº” Objective Cã€Linux å¯¹åº” Cã€Windows å¯¹åº” C++ã€‚

#### å®ƒç”±ä»€ä¹ˆç»„æˆï¼Ÿ
Electron ç»“åˆäº† **Chromium**ã€**Node.js** å’Œç”¨äºè°ƒç”¨æ“ä½œç³»ç»Ÿæœ¬åœ°åŠŸèƒ½çš„ APIï¼ˆå¦‚æ‰“å¼€æ–‡ä»¶çª—å£ã€é€šçŸ¥ã€å›¾æ ‡ç­‰ï¼‰ã€‚
 
- **Chromium**ï¼šGoogle åˆ›é€ çš„ä¸€ä¸ªå¼€æºåº“ï¼Œå¹¶ç”¨äº Google çš„æµè§ˆå™¨ Chromeã€‚
- **Node.jsï¼ˆNodeï¼‰**ï¼šä¸€ä¸ªåœ¨æœåŠ¡å™¨è¿è¡Œ JavaScript çš„è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ï¼Œå®ƒæ‹¥æœ‰è®¿é—®æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œæƒé™ï¼ˆä½ çš„ç”µè„‘ä¹Ÿå¯ä»¥æ˜¯ä¸€å°æœåŠ¡å™¨ï¼ï¼‰ã€‚

![Electron çš„ç»„æˆ][4]

#### å¼€å‘ä½“éªŒå¦‚ä½•ï¼Ÿ
åŸºäº Electron çš„å¼€å‘å°±åƒåœ¨å¼€å‘ç½‘é¡µï¼Œè€Œä¸”èƒ½å¤Ÿæ— ç¼åœ° **ä½¿ç”¨ Node**ã€‚æˆ–è€…è¯´ï¼šåœ¨æ„å»ºä¸€ä¸ª Node åº”ç”¨çš„åŒæ—¶ï¼Œé€šè¿‡ HTML å’Œ CSS æ„å»ºç•Œé¢ã€‚å¦å¤–ï¼Œä½ åªéœ€ä¸ºä¸€ä¸ªæµè§ˆå™¨ï¼ˆ**æœ€æ–°çš„ Chrome**ï¼‰è¿›è¡Œè®¾è®¡ï¼ˆå³æ— éœ€è€ƒè™‘å…¼å®¹æ€§ç­‰ï¼‰ã€‚

 - **ä½¿ç”¨ Node**ï¼šè¿™è¿˜ä¸æ˜¯å…¨éƒ¨ï¼é™¤äº†å®Œæ•´çš„ Node APIï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨æ‰˜ç®¡åœ¨ npm ä¸Šè¶…è¿‡ 350,000 ä¸ªçš„æ¨¡å—ã€‚ 
 - **ä¸€ä¸ªæµè§ˆå™¨**ï¼šå¹¶éæ‰€æœ‰æµè§ˆå™¨éƒ½æä¾›ä¸€è‡´çš„æ ·å¼ï¼ŒWeb è®¾è®¡å¸ˆå’Œå¼€å‘è€…ç»å¸¸å› æ­¤è€Œä¸å¾—ä¸èŠ±è´¹æ›´å¤šçš„ç²¾åŠ›ï¼Œè®©ç½‘ç«™åœ¨ä¸åŒæµè§ˆå™¨ä¸Šè¡¨ç°ä¸€è‡´ã€‚
 - **æœ€æ–°çš„ Chrome**ï¼šå¯ä½¿ç”¨è¶…è¿‡ 90% çš„ ES2015 ç‰¹æ€§å’Œå…¶å®ƒå¾ˆé…·çš„ç‰¹æ€§ï¼ˆå¦‚ CSS å˜é‡ï¼‰ã€‚
 

#### ä¸¤ä¸ªè¿›ç¨‹ï¼ˆé‡ç‚¹ï¼‰
Electron æœ‰ä¸¤ç§è¿›ç¨‹ï¼šã€ä¸»è¿›ç¨‹ã€å’Œã€æ¸²æŸ“è¿›ç¨‹ã€ã€‚éƒ¨åˆ†æ¨¡å—åªèƒ½åœ¨ä¸¤è€…ä¹‹ä¸€ä¸Šè¿è¡Œï¼Œè€Œæœ‰äº›åˆ™æ— é™åˆ¶ã€‚ä¸»è¿›ç¨‹æ›´å¤šåœ°å……å½“å¹•åè§’è‰²ï¼Œè€Œæ¸²æŸ“è¿›ç¨‹åˆ™æ˜¯åº”ç”¨ç¨‹åºçš„å„ä¸ªçª—å£ã€‚  

> æ³¨ï¼šå¯é€šè¿‡ä»»åŠ¡ç®¡ç†å™¨ï¼ˆPCï¼‰/æ´»åŠ¨ç›‘è§†å™¨ï¼ˆMacï¼‰æŸ¥çœ‹è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ã€‚

 - **æ¨¡å—**ï¼šElectron çš„ API æ˜¯æ ¹æ®å®ƒä»¬çš„ç”¨é€”è¿›è¡Œåˆ†ç»„ã€‚ä¾‹å¦‚ï¼š`dialog` æ¨¡å—æ‹¥æœ‰æ‰€æœ‰åŸç”Ÿ dialog çš„ APIï¼Œå¦‚æ‰“å¼€æ–‡ä»¶ã€ä¿å­˜æ–‡ä»¶å’Œè­¦å‘Šç­‰å¼¹çª—ã€‚

#### ä¸»è¿›ç¨‹
ä¸»è¿›ç¨‹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå‘½åä¸º `main.js` çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯æ¯ä¸ª Electron åº”ç”¨çš„å…¥å£ã€‚å®ƒæ§åˆ¶äº†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä»æ‰“å¼€åˆ°å…³é—­ï¼‰ã€‚å®ƒæ—¢èƒ½**è°ƒç”¨åŸç”Ÿå…ƒç´ **ï¼Œä¹Ÿèƒ½åˆ›å»ºæ–°çš„ï¼ˆå¤šä¸ªï¼‰æ¸²æŸ“è¿›ç¨‹ã€‚å¦å¤–ï¼ŒNode API æ˜¯å†…ç½®å…¶ä¸­çš„ã€‚

 - **è°ƒç”¨åŸç”Ÿå…ƒç´ **ï¼šæ‰“å¼€ diglog å’Œå…¶å®ƒæ“ä½œç³»ç»Ÿçš„äº¤äº’å‡æ˜¯èµ„æºå¯†é›†å‹æ“ä½œï¼ˆæ³¨ï¼šå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæ¸²æŸ“è¿›ç¨‹æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®æœ¬åœ°èµ„æºçš„ï¼‰ï¼Œå› æ­¤éƒ½éœ€è¦åœ¨ä¸»è¿›ç¨‹å®Œæˆã€‚

![ä¸»è¿›ç¨‹][5]

#### æ¸²æŸ“è¿›ç¨‹
æ¸²æŸ“è¿›ç¨‹æ˜¯åº”ç”¨çš„ä¸€ä¸ªæµè§ˆå™¨çª—å£ã€‚ä¸ä¸»è¿›ç¨‹ä¸åŒï¼Œå®ƒèƒ½å­˜åœ¨å¤šä¸ªï¼ˆæ³¨ï¼šä¸€ä¸ª Electron åº”ç”¨åªèƒ½å­˜åœ¨ä¸€ä¸ªä¸»è¿›ç¨‹ï¼‰å¹¶ä¸”**ç›¸äº’ç‹¬ç«‹**ï¼ˆå®ƒä¹Ÿèƒ½æ˜¯**éšè—çš„**ï¼‰ã€‚ä¸»çª—å£é€šå¸¸è¢«å‘½åä¸º `index.html`ã€‚å®ƒä»¬å°±åƒå…¸å‹çš„ HTML æ–‡ä»¶ï¼Œä½† Electron èµ‹äºˆäº†å®ƒä»¬å®Œæ•´çš„ Node APIã€‚å› æ­¤ï¼Œè¿™ä¹Ÿæ˜¯å®ƒä¸æµè§ˆå™¨çš„åŒºåˆ«ã€‚

 - **ç›¸äº’ç‹¬ç«‹**ï¼šæ¯ä¸ªæ¸²æŸ“è¿›ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œè¿™æ„å‘³ç€æŸä¸ªæ¸²æŸ“è¿›ç¨‹çš„å´©æºƒï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä½™æ¸²æŸ“è¿›ç¨‹ã€‚
 - **éšè—**ï¼šå¯éšè—çª—å£ï¼Œç„¶åè®©å…¶åœ¨èƒŒåè¿è¡Œä»£ç ï¼ˆğŸ‘ï¼‰ã€‚

![æ¸²æŸ“è¿›ç¨‹][6]

#### æŠŠå®ƒä»¬æƒ³è±¡æˆè¿™æ ·

Chromeï¼ˆæˆ–å…¶ä»–æµè§ˆå™¨ï¼‰çš„æ¯ä¸ªæ ‡ç­¾é¡µï¼ˆtabï¼‰åŠå…¶é¡µé¢ï¼Œå°±å¥½æ¯” Electron ä¸­çš„ä¸€ä¸ªå•ç‹¬æ¸²æŸ“è¿›ç¨‹ã€‚å³ä½¿å…³é—­æ‰€æœ‰æ ‡ç­¾é¡µï¼ŒChrome ä¾ç„¶å­˜åœ¨ã€‚è¿™å¥½æ¯” Electron çš„ä¸»è¿›ç¨‹ï¼Œèƒ½æ‰“å¼€æ–°çš„çª—å£æˆ–å…³é—­è¿™ä¸ªåº”ç”¨ã€‚

> æ³¨ï¼šåœ¨ Chrome æµè§ˆå™¨ä¸­ï¼Œä¸€ä¸ªæ ‡ç­¾é¡µï¼ˆtabï¼‰ä¸­çš„é¡µé¢ï¼ˆå³é™¤äº†æµè§ˆå™¨æœ¬èº«éƒ¨åˆ†ï¼Œå¦‚æœç´¢æ¡†ã€å·¥å…·æ ç­‰ï¼‰å°±æ˜¯ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚

![æŠŠå®ƒä»¬æƒ³è±¡æˆè¿™æ ·][7]


#### ç›¸äº’é€šè®¯
ç”±äºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹å„è‡ªè´Ÿè´£ä¸åŒçš„ä»»åŠ¡ï¼Œè€Œå¯¹äºéœ€è¦ååŒå®Œæˆçš„ä»»åŠ¡ï¼Œå®ƒä»¬éœ€è¦ç›¸äº’é€šè®¯ã€‚**IPC**å°±ä¸ºæ­¤è€Œç”Ÿï¼Œå®ƒæä¾›äº†è¿›ç¨‹é—´çš„é€šè®¯ã€‚ä½†å®ƒåªèƒ½åœ¨ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹ä¹‹é—´ä¼ é€’ä¿¡æ¯ï¼ˆå³æ¸²æŸ“è¿›ç¨‹ä¹‹é—´ä¸èƒ½è¿›è¡Œç›´æ¥é€šè®¯ï¼‰ã€‚

 - **IPC**ï¼šä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹å„è‡ªæ‹¥æœ‰ä¸€ä¸ª IPC æ¨¡å—ã€‚

![IPC Main ä¸ IPC Renderer][8]

#### æ±‡æˆä¸€å¥è¯
Electron åº”ç”¨å°±åƒ Node åº”ç”¨ï¼Œå®ƒä¹Ÿä¾èµ–ä¸€ä¸ª `package.json` æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å®šä¹‰äº†å“ªä¸ªæ–‡ä»¶ä½œä¸ºä¸»è¿›ç¨‹ï¼Œå¹¶å› æ­¤è®© Electron çŸ¥é“ä»ä½•å¯åŠ¨åº”ç”¨ã€‚ç„¶åä¸»è¿›ç¨‹èƒ½åˆ›å»ºæ¸²æŸ“è¿›ç¨‹ï¼Œå¹¶èƒ½ä½¿ç”¨ IPC è®©ä¸¤è€…é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚

![æ±‡æˆä¸€å¥è¯][9]

è‡³æ­¤ï¼ŒElectron çš„åŸºç¡€éƒ¨åˆ†ä»‹ç»å®Œæ¯•ã€‚è¯¥éƒ¨åˆ†æ˜¯åŸºäºç¬”è€…ä¹‹å‰ç¿»è¯‘çš„ä¸€ç¯‡æ–‡ç« [ã€ŠEssential Electronã€‹][10]ï¼Œè¯‘æ–‡å¯ç‚¹å‡» [è¿™é‡Œ][11]ã€‚

  -----

### Vue å…¨å®¶æ¡¶
è¯¥å·¥å…·ä½¿ç”¨äº† Vueã€Vuexã€Vuex-routerã€‚åœ¨å·¥å…·åŸºæœ¬å®šå‹é˜¶æ®µï¼Œç”± 1.x å‡çº§åˆ°äº† 2.xã€‚

#### ä¸ºä»€ä¹ˆé€‰æ‹© Vue
å¯¹äºç¬”è€…æ¥è¯´ï¼š

 - ç®€å•æ˜“ç”¨ï¼Œä¸€èˆ¬ä½¿ç”¨åªéœ€çœ‹å®˜æ–¹æ–‡æ¡£ã€‚
 - æ•°æ®é©±åŠ¨è§†å›¾ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ç”¨æ“ä½œ DOM äº†ã€‚
 - æ¡†æ¶çš„å­˜åœ¨æ˜¯ä¸ºäº†å¸®åŠ©æˆ‘ä»¬åº”å¯¹å¤æ‚åº¦ã€‚
 - å…¨å®¶æ¡¶çš„å¥½å¤„æ˜¯ï¼šå¯¹äºä¸€èˆ¬åœºæ™¯ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦è€ƒè™‘ç”¨å“ªäº›ä¸ªåº“ï¼ˆæ’ä»¶ï¼‰ã€‚

Vue 1.x -> Vue 2.0 çš„ç‰ˆæœ¬è¿ç§»ç”¨ [vue-migration-helper][12] å³å¯åˆ†æå‡ºå¤§éƒ¨åˆ†éœ€è¦æ›´æ”¹çš„åœ°æ–¹ã€‚

ç½‘ä¸Šå·²æœ‰å¾ˆå¤šå…³äº Vue çš„æ•™ç¨‹ï¼Œæ•…åœ¨æ­¤ä¸å†èµ˜è¿°ã€‚è‡³æ­¤ï¼ŒVue éƒ¨åˆ†ä»‹ç»å®Œæ¯•ã€‚

-----

### js-xlsx
è¯¥åº“æ”¯æŒå„ç§ç”µå­è¡¨æ ¼æ ¼å¼çš„è§£æä¸ç”Ÿæˆã€‚å®ƒç”± JavaScript å®ç°ï¼Œé€‚ç”¨äºå‰ç«¯å’Œ Nodeã€‚[è¯¦æƒ…>>][13]

ç›®å‰æ”¯æŒè¯»å…¥çš„æ ¼å¼æœ‰ï¼ˆä¸æ–­æ›´æ–°ï¼‰ï¼š

 - Excel 2007+ XML Formats (XLSX/XLSM)
 - Excel 2007+ Binary Format (XLSB)
 - Excel 2003-2004 XML Format (XML "SpreadsheetML")
 - Excel 97-2004 (XLS BIFF8)
 - Excel 5.0/95 (XLS BIFF5)
 - OpenDocument Spreadsheet (ODS)

æ”¯æŒå†™å‡ºçš„æ ¼å¼æœ‰ï¼š

 - XLSX
 - CSV (and general DSV)
 - JSON and JS objects (various styles)

ç›®å‰è¯¥åº“æä¾›çš„ `sheet_to_json` æ–¹æ³•èƒ½å°†è¯»å…¥çš„ Excel æ•°æ®è½¬ä¸º JSON æ ¼å¼ã€‚è€Œå¯¹äºå¯¼å‡ºæ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ä¸º js-xlsx æä¾›æŒ‡å®šçš„ JSON æ ¼å¼ã€‚

æ›´å¤šå…³äº Excel åœ¨ JavaScript ä¸­å¤„ç†çš„çŸ¥è¯†å¯æŸ¥çœ‹å‡¹å‡¸å®éªŒå®¤çš„[ã€ŠNodeè¯»å†™Excelæ–‡ä»¶æ¢ç©¶å®è·µã€‹][14]ã€‚ä½†è¯¥æ–‡ç« å­˜åœ¨ä¸¤å¤„é—®é¢˜ï¼ˆå‡åœ¨ js-xlsx å®æˆ˜çš„å¯¼å‡ºè¡¨æ ¼éƒ¨åˆ†ï¼‰ï¼š

1. ç”Ÿæˆå¤´éƒ¨æ—¶ï¼ŒExcel çš„åˆ—ä¿¡æ¯ç®€å•åœ°é€šè¿‡ `String.fromCharCode(65+j)` ç”Ÿæˆã€‚å½“åˆ—å¤§äº 26 æ—¶ä¼šå‡ºç°é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜ä¼šåœ¨åé¢ç« èŠ‚ä¸­ç»™å‡ºè§£å†³æ–¹æ¡ˆï¼›
2. è½¬æ¢æˆ worksheet éœ€è¦çš„ç»“æ„å¤„ï¼Œå‡ºç°é€»è¾‘æ€§é”™è¯¯ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚é€»è¾‘é—®é¢˜åœ¨æ­¤ä¸è®²è¿°ï¼Œæˆ‘ä»¬çœ‹çœ‹æ€§èƒ½é—®é¢˜ï¼š
 éšç€ ECMAScript çš„ä¸æ–­æ›´æ–°ï¼ŒJavaScript å˜å¾—æ›´åŠ å¼ºå¤§å’Œæ˜“ç”¨ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦åšåˆ°ã€ç‰©å°½æ‰€ç”¨ã€ï¼Œè€Œä¸è¦ã€å¤§æå°ç”¨ã€ï¼Œå¦åˆ™å¯èƒ½ä¼šå¾—åˆ°â€œåæ•ˆæœâ€ã€‚è¿™é‡Œå¯¼è‡´æ€§èƒ½é—®é¢˜çš„æ­£æ˜¯ [Object.assign()][15] æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æŠŠä»»æ„å¤šä¸ªæºå¯¹è±¡çš„å¯æšä¸¾å±æ€§æ‹·è´è‡³ç›®æ ‡å¯¹è±¡ï¼Œå¹¶è¿”å›ç›®æ ‡å¯¹è±¡ã€‚ç”±äºè¯¥æ–¹æ³•è‡ªèº«çš„å®ç°æœºåˆ¶ï¼Œä¼šåœ¨æ­¤æ¡ˆä¾‹ä¸­äº§ç”Ÿå¤§é‡çš„å†—ä½™æ“ä½œã€‚åœ¨è¯¥æ¡ˆä¾‹ä¸­ï¼Œå•å…ƒæ ¼ä¿¡æ¯æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡ forEach ä¸ºä¸€ä¸ªç©ºå¯¹è±¡èµ‹å€¼å³å¯ã€‚æå‡ N å€æ€§èƒ½çš„åŒæ—¶ï¼Œä¹ŸæŠŠé€»è¾‘æ€§é”™è¯¯è§£å†³äº†ã€‚

åŸæ¥çš„ï¼š
```
var result = æŸæ•°ç»„.reduce((prev, next) => Object.assign({}, prev, {[next.position]: {v: next.v}}), {});
```
æ”¹ä¸ºï¼š
```
var result = æŸæ•°ç»„.forEach((v, i) => data[v.position]= {v: v.v})
```

--- 

**å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†**

åœ¨ç†è§£ä¸Šè¿°çŸ¥è¯†åï¼Œä¸‹é¢å°±è°ˆè°ˆåœ¨è¯¥é¡¹ç›®å®è·µä¸­æ€»ç»“å‡ºæ¥çš„**æŠ€å·§ã€éš¾ç‚¹å’Œé‡ç‚¹**ã€‚

## CSSã€JavaScript å’Œ Electron ç›¸å…³çš„çŸ¥è¯†å’ŒæŠ€å·§

### é«˜äº® table çš„åˆ—
Excel å•å…ƒæ ¼é‡‡ç”¨ `table` æ ‡ç­¾å±•ç¤ºã€‚åœ¨ Excel ä¸­ï¼Œè¢«é€‰ä¸­çš„å•å…ƒæ ¼ä¼šé«˜äº®ç›¸åº”çš„ã€è¡Œã€å’Œã€åˆ—ã€ï¼Œä»¥æé†’ç”¨æˆ·ã€‚åœ¨è¯¥åº”ç”¨ä¸­ä¹Ÿæœ‰åšç›¸åº”çš„å¤„ç†ï¼Œæ¨ªå‘é«˜äº®é‡‡ç”¨ `tr:hover` å®ç°ï¼Œè€Œçºµå‘å‘¢ï¼Ÿè¿™é‡Œæ‰€é‡‡ç”¨çš„ä¸€ä¸ªæŠ€å·§æ˜¯ï¼š

å‡è®¾ HTML ç»“æ„å¦‚ä¸‹ï¼š
```
div.container
  table
    tr
      td
```
CSS ä»£ç å¦‚ä¸‹ï¼š
```
.container { overflow:hidden; }
td { position: relative; }
td:hover::after { 
  position: absolute; 
  left: 0; 
  right: 0; 
  top: -1ä¸ªäº¿px; // å°ç›®æ ‡è¾¾æˆï¼Œä¸è¿‡æ˜¯è´Ÿçš„ğŸ˜­
  bottom: -1ä¸ªäº¿px; 
  z-index: -1; // é¿å…é®ä½è‡ªèº«å’ŒåŒåˆ— td çš„å†…å®¹ã€border ç­‰
}
```

### æ–œåˆ†å‰²çº¿
å¦‚å›¾ï¼š![æ–œåˆ†å‰²çº¿][16]

åˆ†å‰²çº¿å¯ä»¥é€šè¿‡ `::after/::before` ä¼ªç±»å…ƒç´ å®ç°ä¸€æ¡ç›´çº¿ï¼Œç„¶åé€šè¿‡ `transform:rotate();` æ—‹è½¬ç‰¹å®šè§’åº¦å®ç°ã€‚ä½†è¿™ç§å®ç°çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šç”±äºå®½åº¦æ˜¯ä¸å®šçš„ï¼Œå› æ­¤éœ€è¦é€šè¿‡ JavaScript è¿ç®—æ‰èƒ½å¾—åˆ°å‡†ç¡®çš„å¯¹è§’åˆ†å‰²çº¿ã€‚

å› æ­¤ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ CSS çº¿æ€§æ¸å˜ `linear-gradient(to top right, transparent, transparent calc(50% - .5px), #d3d6db calc(50% - .5px), #d3d6db calc(50% + .5px), transparent calc(50% + .5px))` å®ç°ã€‚æ— è®ºå®½é«˜å¦‚ä½•å˜ï¼Œä¾ç„¶å¦¥å¦¥åœ°è‡ªé€‚åº”ã€‚


### Excel çš„åˆ—è½¬æ¢

 - Excel çš„åˆ—éœ€è¦ç”¨ã€å­—æ¯ã€è¡¨ç¤ºï¼Œä½†ä¸èƒ½ç®€å•åœ°é€šè¿‡ [String.fromCharCode()][17] å®ç°ï¼Œå› ä¸ºå½“è¶…å‡º `26 åˆ—` æ—¶å°±ä¼šäº§ç”Ÿé—®é¢˜ï¼ˆå¦‚ï¼šç¬¬ `27` åˆ—ï¼Œ`String.fromCharCode(65+26)` å¾—åˆ°çš„æ˜¯ `[`ï¼Œè€Œä¸æ˜¯ `AA`ï¼‰ã€‚å› æ­¤ï¼Œè¿™éœ€è¦é€šè¿‡ã€åè¿›åˆ¶å’Œ 26 è¿›åˆ¶è½¬æ¢ã€ç®—æ³•æ¥å®ç°ã€‚

```
// å°†ä¼ å…¥çš„è‡ªç„¶æ•°è½¬æ¢ä¸º26è¿›åˆ¶è¡¨ç¤ºã€‚æ˜ å°„å…³ç³»ï¼š[0-25] -> [A-Z]ã€‚
function getCharCol (n) {
  let s = ''
  let m = 0
  while (n >= 0) {
    m = (n % 26) + 1
    s = String.fromCharCode(m + 64) + s
    n = (n - m) / 26
  }
  return s
}
```

```
// å°†ä¼ å…¥çš„26è¿›åˆ¶è½¬æ¢ä¸ºè‡ªç„¶æ•°ã€‚æ˜ å°„å…³ç³»ï¼š[A-Z] ->[0-25]ã€‚
function getNumCol (s) {
  if (!s) return 0
  let n = 0
  for (let i = s.length - 1, j = 1; i >= 0; i--, j *= 26) {
    const c = s[i].toUpperCase()
    if (c < 'A' || c > 'Z') return 0
    n += (c.charCodeAt() - 64) * j
  }
  return n - 1
}
```


### ä¸º DOM çš„ File å¯¹è±¡å¢åŠ äº† path å±æ€§
Electron ä¸º File å¯¹è±¡é¢å¤–å¢äº† path å±æ€§ï¼Œè¯¥å±æ€§å¯å¾—åˆ°æ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„çœŸå®è·¯å¾„ã€‚å› æ­¤ï¼Œä½ å¯ä»¥åˆ©ç”¨ Node ä¸ºæ‰€æ¬²ä¸ºğŸ˜ˆã€‚åº”ç”¨åœºæ™¯æœ‰ï¼šæ‹–æ‹½æ–‡ä»¶åï¼Œé€šè¿‡ Node æä¾›çš„ File API è¯»å–æ–‡ä»¶ç­‰ã€‚


### æ”¯æŒå¸¸è§çš„ç¼–è¾‘åŠŸèƒ½ï¼Œå¦‚ç²˜è´´å’Œå¤åˆ¶
Electron åº”ç”¨åœ¨ MacOS ä¸­é»˜è®¤ä¸æ”¯æŒã€å¤åˆ¶ã€ã€ç²˜è´´ã€ç­‰å¸¸è§ç¼–è¾‘åŠŸèƒ½ï¼Œå› æ­¤éœ€è¦ä¸º MacOS æ˜¾å¼åœ°è®¾ç½®å¤åˆ¶ç²˜è´´ç­‰ç¼–è¾‘åŠŸèƒ½çš„èœå•æ ï¼Œå¹¶ä¸ºæ­¤è®¾ç½®ç›¸åº”çš„å¿«æ·é”®ã€‚

```
// darwin å°±æ˜¯ MacOS
if (process.platform === 'darwin') {
    var template = [{
      label: 'FromScratch',
      submenu: [{
        label: 'Quit',
        accelerator: 'CmdOrCtrl+Q',
        click: function() { app.quit(); }
      }]
    }, {
      label: 'Edit',
      submenu: [{
        label: 'Undo',
        accelerator: 'CmdOrCtrl+Z',
        selector: 'undo:'
      }, {
        label: 'Redo',
        accelerator: 'Shift+CmdOrCtrl+Z',
        selector: 'redo:'
      }, {
        type: 'separator'
      }, {
        label: 'Cut',
        accelerator: 'CmdOrCtrl+X',
        selector: 'cut:'
      }, {
        label: 'Copy',
        accelerator: 'CmdOrCtrl+C',
        selector: 'copy:'
      }, {
        label: 'Paste',
        accelerator: 'CmdOrCtrl+V',
        selector: 'paste:'
      }, {
        label: 'Select All',
        accelerator: 'CmdOrCtrl+A',
        selector: 'selectAll:'
      }]
    }];
    var osxMenu = menu.buildFromTemplate(template);
    menu.setApplicationMenu(osxMenu);
}
```


### æ›´è´´è¿‘åŸç”Ÿåº”ç”¨
Electron çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼šå³ä½¿ä½ çš„åº”ç”¨æ˜¯ä¸€ä¸ªç®€å•çš„æ—¶é’Ÿï¼Œä½†å®ƒä¹Ÿä¸å¾—ä¸åŒ…å«å®Œæ•´çš„åŸºç¡€è®¾æ–½ï¼ˆå¦‚ Chromiumã€Node ç­‰ï¼‰ã€‚å› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‰“åŒ…åçš„ç¨‹åºè‡³å°‘ä¼šè¾¾åˆ°å‡ åå…†ï¼ˆæ ¹æ®ç³»ç»Ÿç±»å‹è¿›è¡Œæµ®åŠ¨ï¼‰ã€‚å½“ä½ çš„åº”ç”¨è¶Šå¤æ‚ï¼Œå°±è¶Šå¯ä»¥å¿½ç•¥æ–‡ä»¶ä½“ç§¯é—®é¢˜ã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼Œé¡µé¢çš„æ¸²æŸ“éš¾å…ä¼šå¯¼è‡´ã€ç™½å±ã€ï¼Œè€Œä¸”è¿™é‡Œé‡‡ç”¨äº† Vue è¿™ç±»æ¡†æ¶ï¼Œæƒ…å†µå°±æ›´åŠ ç³Ÿç³•äº†ã€‚å¦å¤–ï¼ŒElectron åº”ç”¨ä¹Ÿé¿å…ä¸äº†ã€å…ˆæ‰“å¼€æµè§ˆå™¨ï¼Œå†æ¸²æŸ“é¡µé¢ã€çš„æ­¥éª¤ã€‚ä¸‹é¢æä¾›å‡ ç§æ–¹æ³•æ¥å‡è½»è¿™ç§æƒ…å†µï¼Œä»¥è®©ç¨‹åºæ›´è´´è¿‘åŸç”Ÿåº”ç”¨ã€‚

1. æŒ‡å®š BrowserWindow çš„èƒŒæ™¯é¢œè‰²ï¼›
2. å…ˆéšè—çª—å£ï¼Œç›´åˆ°é¡µé¢åŠ è½½åå†æ˜¾ç¤ºï¼›
3. ä¿å­˜çª—å£çš„å°ºå¯¸å’Œä½ç½®ï¼Œä»¥è®©ç¨‹åºä¸‹æ¬¡è¢«æ‰“å¼€æ—¶ï¼Œä¾ç„¶ä¿ç•™çš„åŒæ ·å¤§å°å’Œå‡ºç°åœ¨åŒæ ·çš„ä½ç½®ä¸Šã€‚

å¯¹äºç¬¬ä¸€ç‚¹ï¼Œè‹¥åº”ç”¨çš„èƒŒæ™¯ä¸æ˜¯çº¯ç™½ï¼ˆ`#fff`ï¼‰çš„ï¼Œé‚£ä¹ˆå¯æŒ‡å®šçª—å£çš„èƒŒæ™¯é¢œè‰²ä¸å…¶ä¸€è‡´ï¼Œä»¥é¿å…æ¸²æŸ“åçš„çªå˜ã€‚
```
mainWindow = new BrowserWindow({
    title: 'XCel',
    backgroundColor: '#f5f5f5',
};
```

å¯¹äºç¬¬äºŒç‚¹ï¼Œç”±äº Electron æœ¬è´¨æ˜¯ä¸€ä¸ªæµè§ˆå™¨ï¼Œéœ€è¦åŠ è½½éç½‘é¡µéƒ¨åˆ†çš„èµ„æºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆéšè—çª—å£ã€‚
```
var mainWindow = new BrowserWindow({
    title: 'ElectronApp',
    show: false,
};
```
ç­‰åˆ°æ¸²æŸ“è¿›ç¨‹å¼€å§‹æ¸²æŸ“é¡µé¢çš„é‚£ä¸€åˆ»ï¼Œåœ¨ `ready-to-show` çš„å›è°ƒå‡½æ•°ä¸­æ˜¾ç¤ºçª—å£ã€‚  
```
mainWindow.on('ready-to-show', function() {
    mainWindow.show();
    mainWindow.focus();
});
```

å¯¹äºç¬¬ä¸‰ç‚¹ï¼Œç¬”è€…å¹¶æ²¡æœ‰å®ç°ï¼ŒåŸå› å¦‚ä¸‹ï¼š

1. ç”¨æˆ·ä¸€èˆ¬æ˜¯æ ¹æ®å½“æ—¶çš„æƒ…å†µå¯¹ç¨‹åºçš„å°ºå¯¸å’Œä½ç½®è¿›è¡Œè°ƒæ•´ï¼Œå³è§†æƒ…å†µè€Œå®šã€‚
2. ä»¥ä¸Šæ˜¯æˆ‘ä¸ªäººè‡†æµ‹ï¼Œä¸»è¦æ˜¯æˆ‘æ‡’ğŸ¶ã€‚

å…¶å®ç°æ–¹å¼ï¼Œå¯å‚è€ƒ[ã€Š4 must-know tips for building cross platform Electron appsã€‹][18]ã€‚

### å¦‚ä½•åœ¨æ¸²æŸ“è¿›ç¨‹è°ƒç”¨åŸç”Ÿå¼¹æ¡†ï¼Ÿ
åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­è°ƒç”¨åŸæœ¬ä¸“å±äºä¸»è¿›ç¨‹ä¸­çš„ API ï¼ˆå¦‚å¼¹æ¡†ï¼‰çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š

1. IPC é€šè®¯æ¨¡å—ï¼šå…ˆåœ¨ä¸»è¿›ç¨‹é€šè¿‡ `ipcMain` è¿›è¡Œç›‘å¬ï¼Œç„¶ååœ¨æ¸²æŸ“è¿›ç¨‹é€šè¿‡ `ipcRenderer` è¿›è¡Œè§¦å‘ï¼›
2. remote æ¨¡å—ï¼šè¯¥æ¨¡å—ä¸ºæ¸²æŸ“è¿›ç¨‹å’Œä¸»è¿›ç¨‹ä¹‹é—´æä¾›äº†å¿«æ·çš„é€šè®¯æ–¹å¼ã€‚

å¯¹äºç¬¬äºŒç§æ–¹å¼ï¼Œåœ¨æ¸²æŸ“è¿›ç¨‹ä¸­ï¼Œè¿è¡Œä»¥ä¸‹ä»£ç å³å¯ï¼š
```
const remote = require('electron').remote

remote.dialog.showMessageBox({
  type: 'question',
  buttons: ['ä¸å‘Šè¯‰ä½ ', 'æ²¡æœ‰æ¢¦æƒ³'],
  defaultId: 0,
  title: 'XCel',
  message: 'ä½ çš„æ¢¦æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ'
}
```

### è‡ªåŠ¨æ›´æ–°
å¦‚æœ Electron åº”ç”¨æ²¡æœ‰æä¾›è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ç”¨æˆ·æƒ³ä½“éªŒæ–°å¼€å‘çš„åŠŸèƒ½æˆ–ç”¨ä¸Šä¿®å¤ Bug åçš„æ–°ç‰ˆæœ¬ï¼Œåªèƒ½é ç”¨æˆ·è‡ªå·±ä¸»åŠ¨åœ°å»å®˜ç½‘ä¸‹è½½ï¼Œè¿™æ— ç–‘æ˜¯ç³Ÿç³•çš„ä½“éªŒã€‚Electron æä¾›çš„ [autoUpdater][19] æ¨¡å—å¯å®ç°è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œè¯¥æ¨¡å—æä¾›äº†ç¬¬ä¸‰æ–¹æ¡†æ¶ [Squirrel][20] çš„æ¥å£ï¼Œä½† Electron ç›®å‰åªå†…ç½®äº† [Squirrel.Mac][21]ï¼Œä¸”å®ƒä¸ [Squirrel.Windows][22]ï¼ˆéœ€è¦é¢å¤–å¼•å…¥ï¼‰çš„å¤„ç†æ–¹å¼ä¹Ÿä¸ä¸€è‡´ï¼ˆåœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ä¸¤æ–¹é¢ï¼‰ã€‚å› æ­¤å¦‚æœå¯¹è¯¥æ¨¡å—ä¸ç†Ÿæ‚‰ï¼Œå¤„ç†èµ·æ¥ä¼šç›¸å¯¹æ¯”è¾ƒç¹çã€‚å…·ä½“å¯ä»¥å‚è€ƒç¬”è€…çš„å¦ä¸€ç¯‡è¯‘æ–‡[ã€ŠElectron è‡ªåŠ¨æ›´æ–°çš„å®Œæ•´æ•™ç¨‹ï¼ˆWindows å’Œ OSXï¼‰ã€‹][23]ã€‚

> ç›®å‰ Electron çš„ autoUpdater æ¨¡å—ä¸æ”¯æŒ Linux ç³»ç»Ÿã€‚

å¦å¤–ï¼ŒXCel ç›®å‰å¹¶æ²¡æœ‰é‡‡ç”¨ autoUpdater æ¨¡å—å®ç°è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œè€Œæ˜¯åˆ©ç”¨ Electron çš„ [DownloadItem][24] æ¨¡å—å®ç°ï¼Œè€ŒæœåŠ¡å™¨ç«¯åˆ™é‡‡ç”¨äº† [Nuts][25]ã€‚

### ä¸º Electron åº”ç”¨ç”Ÿæˆ Windows å®‰è£…åŒ…
é€šè¿‡ [electron-builder](https://www.electron.build/) å¯ç›´æ¥ç”Ÿæˆå¸¸è§çš„ MacOS å®‰è£…åŒ…ï¼Œä½†å®ƒç”Ÿæˆçš„ Windows çš„å®‰è£…åŒ…å´ç•¥æ˜¾ç®€æ´ï¼ˆé»˜è®¤é€‰é¡¹æ—¶ï¼‰ã€‚

![å¸¸è§çš„MacOS å®‰è£…åŒ…][26]    
Mac å¸¸è§çš„å®‰è£…æ¨¡å¼ï¼Œå°†â€œå·¦ä¾§çš„åº”ç”¨å›¾æ ‡â€æ‹–æ‹½åˆ°â€œå³ä¾§çš„ Applicationsâ€å³å¯

é€šè¿‡ electron-builder ç”Ÿæˆçš„ Windows å®‰è£…åŒ…ä¸æˆ‘ä»¬åœ¨ Windows ä¸Šå¸¸è§çš„è½¯ä»¶å®‰è£…ç•Œé¢ä¸å¤ªä¸€æ ·ï¼Œå®ƒæ²¡æœ‰å®‰è£…å‘å¯¼å’Œç‚¹å‡»â€œä¸‹ä¸€æ­¥â€çš„æŒ‰é’®ï¼Œåªæœ‰ä¸€ä¸ªå®‰è£…æ—¶çš„ gif åŠ¨ç”»ï¼ˆé»˜è®¤çš„ gif åŠ¨ç”»å¦‚ä¸‹å›¾ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æŒ‡å®šç‰¹å®šçš„ gif åŠ¨ç”»ï¼‰ï¼Œå› æ­¤ä¹Ÿå°±å…³é—­äº†ç”¨æˆ·é€‰æ‹©å®‰è£…è·¯å¾„ç­‰æƒåˆ©ã€‚

![Windows å®‰è£…æ—¶é»˜è®¤çš„åŠ¨ç”»][27]  
Windows å®‰è£…æ—¶ [é»˜è®¤æ˜¾ç¤ºçš„ gif åŠ¨ç”»][28]

å¦‚æœä½ æƒ³ä¸ºæ‰“åŒ…åçš„ Electron åº”ç”¨ï¼ˆå³é€šè¿‡ electron-packager/electron-builder ç”Ÿæˆçš„ï¼Œå¯ç›´æ¥è¿è¡Œçš„ç¨‹åºç›®å½•ï¼‰ç”Ÿæˆæ‹¥æœ‰ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®å’Œå¯è®©ç”¨æˆ·æŒ‡å®šå®‰è£…è·¯å¾„çš„å¸¸è§å®‰è£…åŒ…ï¼Œå¯ä»¥å°è¯• NSIS ç¨‹åºï¼Œå…·ä½“å¯çœ‹è¿™ç¯‡æ•™ç¨‹ [ã€Š\[æ•™å­¸\]åªè¦10åˆ†é˜å­¸æœƒä½¿ç”¨ NSIS åŒ…è£æ‚¨çš„æ¡Œé¢è»Ÿé«”â€“å®‰è£ç¨‹å¼æ‰“åŒ…ã€‚å®Œå…¨å…è²»ã€‚ã€‹][29]ã€‚

æ³¨ï¼šelectron-builder ä¹Ÿæä¾›äº†ç”Ÿæˆå®‰è£…åŒ…çš„é…ç½®é¡¹ï¼Œ[å…·ä½“æŸ¥çœ‹>>](https://www.electron.build/configuration/nsis)ã€‚

 > NSISï¼ˆNullsoft Scriptable Install Systemï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ Windows ç³»ç»Ÿä¸‹å®‰è£…ç¨‹åºåˆ¶ä½œç¨‹åºã€‚å®ƒæä¾›äº†å®‰è£…ã€å¸è½½ã€ç³»ç»Ÿè®¾ç½®ã€æ–‡ä»¶è§£å‹ç¼©ç­‰åŠŸèƒ½ã€‚æ­£å¦‚å…¶åå­—æ‰€æè¿°çš„é‚£æ ·ï¼ŒNSIS æ˜¯é€šè¿‡å®ƒçš„è„šæœ¬è¯­è¨€æ¥æè¿°å®‰è£…ç¨‹åºçš„è¡Œä¸ºå’Œé€»è¾‘çš„ã€‚NSIS çš„è„šæœ¬è¯­è¨€å’Œå¸¸è§çš„ç¼–ç¨‹è¯­è¨€æœ‰ç±»ä¼¼çš„ç»“æ„å’Œè¯­æ³•ï¼Œä½†å®ƒæ˜¯ä¸ºå®‰è£…ç¨‹åºè¿™ç±»åº”ç”¨æ‰€è®¾è®¡çš„ã€‚

è‡³æ­¤ï¼ŒCSSã€JavaScript å’Œ Electron ç›¸å…³çš„çŸ¥è¯†å’ŒæŠ€å·§éƒ¨åˆ†é˜è¿°å®Œæ¯•ã€‚

------- 

## æ€§èƒ½ä¼˜åŒ–
ä¸‹é¢è°ˆè°ˆã€æ€§èƒ½ä¼˜åŒ–ã€ï¼Œè¿™éƒ¨åˆ†æ¶‰åŠåˆ°**è¿è¡Œæ•ˆç‡**å’Œ**å†…å­˜å ç”¨é‡**ã€‚     
æ³¨ï¼šä»¥ä¸‹å†…å®¹å‡åŸºäº Excel æ ·ä¾‹æ–‡ä»¶ï¼ˆæ•°æ®é‡ä¸ºï¼š1913 è¡Œ x 180 åˆ—ï¼‰å¾—å‡ºçš„ç»“è®ºã€‚

### æ‰§è¡Œæ•ˆç‡å’Œæ¸²æŸ“çš„ä¼˜åŒ–
#### Vue æ€§èƒ½çœŸçš„å¥½ï¼Ÿ
Vue ä¸€ç›´æ ‡æ¦œç€è‡ªå·±æ€§èƒ½ä¼˜å¼‚ï¼Œä½†å½“æ•°æ®é‡ä¸Šå‡åˆ°ä¸€å®šé‡çº§æ—¶ï¼ˆå¦‚ 1913 x 180 â‰ˆ 34 ä¸‡ä¸ªæ•°æ®å•å…ƒï¼‰ï¼Œä¼šå‡ºç°ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼ˆæœªåšç›¸åº”ä¼˜åŒ–çš„å‰æä¸‹ï¼‰ã€‚

å¦‚ç›´æ¥é€šè¿‡åˆ—è¡¨æ¸²æŸ“ `v-for` æ¸²æŸ“æ•°æ®æ—¶ï¼Œä¼šå¯¼è‡´ç¨‹åºå¡æ­»ã€‚   
ç­”ï¼šé€šè¿‡æŸ¥é˜…ç›¸å…³èµ„æ–™å¯å¾—ï¼Œ `v-for` åœ¨åˆæ¬¡æ¸²æŸ“æ—¶ï¼Œéœ€è¦å¯¹æ¯ä¸ªå­é¡¹è¿›è¡Œåˆå§‹åŒ–ï¼ˆå¦‚æ•°æ®ç»‘å®šç­‰æ“ä½œï¼Œä»¥ä¾¿æ‹¥æœ‰æ›´å¿«çš„æ›´æ–°é€Ÿåº¦ï¼‰ï¼Œè¿™å¯¹äºæ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œæ— ç–‘ä¼šé€ æˆä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚   

å½“æ—¶ï¼Œæˆ‘æƒ³åˆ°äº†ä¸¤ç§è§£å†³æ€è·¯ï¼š

1. Vue æ˜¯æ•°æ®é©±åŠ¨è§†å›¾çš„ï¼Œå¯¹æ•°æ®åˆ†æ®µ pushï¼Œå³å°†ä¸€ä¸ªåºå¤§çš„ä»»åŠ¡åˆ†å‰²ä¸º N ä»½ã€‚
2. è‡ªå·±æ‹¼æ¥ HTML å­—ç¬¦ä¸²ï¼Œå†é€šè¿‡ innerHTML ä¸€æ¬¡æ€§æ’å…¥ã€‚

æœ€ç»ˆï¼Œæˆ‘é€‰æ‹©äº†ç¬¬äºŒæ¡ï¼Œç†ç”±æ˜¯ï¼š

1. æ€§èƒ½æœ€ä½³ï¼Œå› ä¸ºæ¯æ¬¡æ‰§è¡Œæ•°æ®è¿‡æ»¤æ—¶ï¼ŒVue éƒ½è¦è¿›è¡Œ diffï¼Œæ€§èƒ½ä¸ä½³ã€‚
2. æ›´ç¬¦åˆå½“å‰åº”ç”¨çš„éœ€æ±‚ï¼šçº¯å±•ç¤ºä¸”æ— éœ€åŠ¨ç”»è¿‡æ¸¡ç­‰ã€‚
3. å®ç°æ›´ç®€å•

å°†åŸæœ¬ç¹é‡çš„ DOM æ“ä½œï¼ˆVueï¼‰è½¬æ¢ä¸º JavaScript çš„æ‹¼æ¥å­—ç¬¦ä¸²åï¼Œæ€§èƒ½å¾—åˆ°äº†å¾ˆå¤§æå‡ï¼ˆä¸ä¼šå¯¼è‡´ç¨‹åºå¡æ­»è€Œæ¸²æŸ“ä¸å‡ºè§†å›¾ï¼‰ã€‚è¿™ç§ä¼˜åŒ–æ–¹å¼éš¾é“ä¸å°±æ˜¯ Vueã€React ç­‰æ¡†æ¶è§£å†³çš„é—®é¢˜ä¹‹ä¸€å—ï¼Ÿåªä¸è¿‡æ¡†æ¶è€ƒè™‘çš„åœºæ™¯æ›´å¹¿ï¼Œæœ‰äº›åœ°æ–¹éœ€è¦æˆ‘ä»¬è‡ªå·±æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¼˜åŒ–è€Œå·²ã€‚

> åœ¨æµè§ˆå™¨å½“ä¸­ï¼ŒJavaScript çš„è¿ç®—åœ¨ç°ä»£çš„å¼•æ“ä¸­éå¸¸å¿«ï¼Œä½† DOM æœ¬èº«æ˜¯éå¸¸ç¼“æ…¢çš„ä¸œè¥¿ã€‚å½“ä½ è°ƒç”¨åŸç”Ÿ DOM API çš„æ—¶å€™ï¼Œæµè§ˆå™¨éœ€è¦åœ¨ JavaScript å¼•æ“çš„è¯­å¢ƒä¸‹å»æ¥è§¦åŸç”Ÿçš„ DOM çš„å®ç°ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç›¸å½“çš„æ€§èƒ½æŸè€—ã€‚æ‰€ä»¥ï¼Œæœ¬è´¨çš„è€ƒé‡æ˜¯ï¼Œè¦æŠŠè€—è´¹æ—¶é—´çš„æ“ä½œå°½é‡æ”¾åœ¨çº¯ç²¹çš„è®¡ç®—ä¸­å»åšï¼Œä¿è¯æœ€åè®¡ç®—å‡ºæ¥çš„éœ€è¦å®é™…æ¥è§¦çœŸå® DOM çš„æ“ä½œæ˜¯æœ€å°‘çš„ã€‚ â€”â€” [ã€ŠVue 2.0â€”â€”æ¸è¿›å¼å‰ç«¯è§£å†³æ–¹æ¡ˆã€‹][30]


å½“ç„¶ï¼Œç”±äº JavaScript å¤©ç”Ÿå•çº¿ç¨‹ï¼Œå³ä½¿æ‰§è¡Œæ•°é€Ÿåº¦å†å¿«ï¼Œä¹Ÿéš¾å…ä¼šå¯¼è‡´é¡µé¢æœ‰çŸ­æš‚çš„æ—¶é—´æ‹’ç»ç”¨æˆ·çš„è¾“å…¥ã€‚æ­¤æ—¶å¯é€šè¿‡ Web Worker æˆ–å…¶å®ƒæ–¹å¼è§£å†³ï¼Œè¿™ä¹Ÿå°†æ˜¯æˆ‘ä»¬åç»­è®²åˆ°çš„é—®é¢˜ã€‚

ä¹Ÿæœ‰ç½‘å‹æä¾›äº†ä¼˜åŒ–å¤§é‡åˆ—è¡¨çš„æ–¹æ³•ï¼š[https://clusterize.js.org/](https://clusterize.js.org/)ã€‚ä½†åœ¨æ­¤æ¡ˆä¾‹ä¸­ç¬”è€…å¹¶æ²¡æœ‰é‡‡ç”¨æ­¤æ–¹å¼ã€‚

#### å¼ºå¤§çš„ GPU åŠ é€Ÿ
å°†æ‹¼æ¥çš„å­—ç¬¦ä¸²æ’å…¥ DOM åï¼Œå‡ºç°äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼šæ»šåŠ¨ä¼šå¾ˆå¡ã€‚çŒœæƒ³è¿™æ˜¯æ¸²æŸ“é—®é¢˜ï¼Œæ¯•ç«Ÿ 34 ä¸‡ä¸ªå•å…ƒæ ¼åŒæ—¶å­˜åœ¨äºç•Œé¢ä¸­ã€‚

æ·»åŠ  `transform: translate3d(0, 0, 0) / translateZ(0)` å±æ€§å¯åŠ¨ GPU æ¸²æŸ“ï¼Œå³å¯è§£å†³è¿™ä¸ªæ¸²æŸ“æ€§èƒ½é—®é¢˜ã€‚å†æ¬¡æ„Ÿå¹è¯¥å±æ€§çš„å¼ºå¤§ã€‚ğŸ‚

åæ¥ï¼Œè€ƒè™‘åˆ°ç”¨æˆ·å¹¶ä¸éœ€è¦æŸ¥çœ‹å…¨éƒ¨æ•°æ®ï¼Œåªéœ€å±•ç¤ºéƒ¨åˆ†æ•°æ®è®©ç”¨æˆ·è¿›è¡Œå‚è€ƒå³å¯ã€‚æˆ‘ä»¬å¯¹æ­¤åªæ¸²æŸ“å‰ 30/50 è¡Œæ•°æ®ã€‚è¿™æ ·å³å¯æå‡ç”¨æˆ·ä½“éªŒï¼Œä¹Ÿèƒ½è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ã€‚

#### è®°å¾—å…³é—­ Vuex çš„ä¸¥æ ¼æ¨¡å¼
å¦å¤–ï¼Œç”±äºè‡ªå·±å­¦è‰ºä¸ç²¾å’Œç²—å¿ƒå¤§æ„ï¼Œå¿˜è®°åœ¨ç”Ÿäº§ç¯å¢ƒå…³é—­ Vuex çš„ã€ä¸¥æ ¼æ¨¡å¼ã€ã€‚

Vuex çš„ä¸¥æ ¼æ¨¡å¼è¦**åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å…³é—­**ï¼Œå¦åˆ™ä¼šå¯¹ state æ ‘è¿›è¡Œä¸€ä¸ªæ·±è§‚å¯Ÿ (deep watch)ï¼Œäº§ç”Ÿä¸å¿…è¦çš„æ€§èƒ½æŸè€—ã€‚ä¹Ÿè®¸åœ¨æ•°æ®é‡å°‘æ—¶ï¼Œä¸ä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜ã€‚

è¿˜åŸå½“æ—¶çš„åœºæ™¯ï¼šå¯¼å…¥ Excel æ•°æ®åï¼Œå†è¿›è¡Œäº¤äº’ï¼ˆæ¶‰åŠ Vuex çš„è¯»å†™æ“ä½œï¼‰ï¼Œéœ€è¦ç­‰å‡ ç§’æ‰ä¼šå“åº”ï¼Œè€Œç›´æ¥é€šè¿‡çº¯ DOM ç›‘å¬çš„äº‹ä»¶åˆ™æ— æ­¤é—®é¢˜ã€‚ç”±æ­¤ï¼Œåˆ¤æ–­å‡ºæ˜¯ Vuex é—®é¢˜ã€‚

```
const store = new Vuex.Store({
  // ...
  strict: process.env.NODE_ENV !== 'production'
})
```

## å¤šè¿›ç¨‹ï¼ï¼ï¼
å‰é¢è¯´é“ï¼ŒJavaScript å¤©ç”Ÿå•çº¿ç¨‹ï¼Œå³ä½¿å†å¿«ï¼Œå¯¹äºæ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä¹Ÿä¼šå‡ºç°æ‹’ç»å“åº”çš„é—®é¢˜ã€‚å› æ­¤éœ€è¦ Web Worker æˆ–ç±»ä¼¼çš„æ–¹æ¡ˆå»è§£å†³ã€‚

åœ¨è¿™é‡Œæˆ‘ä¸é€‰æ‹© Web worker çš„åŸå› æœ‰å¦‚ä¸‹å‡ ç‚¹ï¼š

1. æœ‰å…¶å®ƒæ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆï¼šä¸€ä¸ªä¸»è¿›ç¨‹èƒ½åˆ›å»ºå¤šä¸ªæ¸²æŸ“è¿›ç¨‹ï¼Œé€šè¿‡ IPC å³å¯è¿›è¡Œæ•°æ®äº¤äº’ï¼›
2. Electron ä¸æ”¯æŒ Web Workerï¼(å½“ç„¶ï¼Œå¯èƒ½ä¼šåœ¨æ–°ç‰ˆæœ¬æ”¯æŒï¼Œæœ€æ–°ä¿¡æ¯è¯·å…³æ³¨å®˜æ–¹)

Electron ä½œè€…åœ¨ 2014.11.7 åœ¨ã€Šstate of web worker support?ã€‹ issue ä¸­å›å¤äº†ä»¥ä¸‹è¿™ä¸€æ®µï¼š
> Node integration doesn't work in web workers, and there is no plan to do. Workers in Chromium are implemented by starting a new thread, and Node is not thread safe. Back in past we had tried to add node integration to web workers in Atom, but it crashed too easily so we gave up on it.

å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆé‡‡ç”¨äº†åˆ›å»ºä¸€ä¸ªæ–°çš„æ¸²æŸ“è¿›ç¨‹ `background process` è¿›è¡Œå¤„ç†æ•°æ®ã€‚ç”± Electron ç« èŠ‚å¯çŸ¥ï¼Œæ¯ä¸ª Electron æ¸²æŸ“è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œå› æ­¤å®ƒä»¬ä¸ä¼šäº’ç›¸å½±å“ã€‚ä½†è¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šå®ƒä»¬ä¸èƒ½ç›¸äº’é€šè®¯ï¼Ÿ

é”™ï¼ä¸‹é¢æœ‰ 3 ç§æ–¹å¼è¿›è¡Œé€šè®¯ï¼š

1. [Storage API][31]ï¼šå¯¹æŸä¸ªæ ‡ç­¾é¡µçš„ localStorage/sessionStorage å¯¹è±¡è¿›è¡Œå¢åˆ æ”¹æ—¶ï¼Œå…¶ä»–æ ‡ç­¾é¡µèƒ½é€šè¿‡ window.storage äº‹ä»¶ç›‘å¬åˆ°ã€‚
2. [IndexedDB][32]ï¼šIndexedDB æ˜¯ä¸€ä¸ªä¸ºäº†èƒ½å¤Ÿåœ¨å®¢æˆ·ç«¯å­˜å‚¨å¯è§‚æ•°é‡çš„ç»“æ„åŒ–æ•°æ®ï¼Œå¹¶ä¸”åœ¨è¿™äº›æ•°æ®ä¸Šä½¿ç”¨ç´¢å¼•è¿›è¡Œé«˜æ€§èƒ½æ£€ç´¢çš„ APIã€‚
3. é€šè¿‡ä¸»è¿›ç¨‹ä½œä¸ºä¸­è½¬ç«™ï¼šè®¾ä¸»ç•Œé¢çš„æ¸²æŸ“è¿›ç¨‹æ˜¯ Aï¼Œ`background process` æ˜¯ Bï¼Œé‚£ä¹ˆ A å…ˆå°† Excel æ•°æ®ä¼ é€’åˆ°ä¸»è¿›ç¨‹ï¼Œç„¶åä¸»è¿›ç¨‹å†è½¬å‘åˆ° Bã€‚B å¤„ç†å®Œåå†åŸè·¯è¿”å›ï¼Œå…·ä½“å¦‚ä¸‹å›¾ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å°†æ•°æ®å­˜å‚¨åœ¨ä¸»è¿›ç¨‹ä¸­ï¼Œç„¶ååœ¨å¤šä¸ªæ¸²æŸ“è¿›ç¨‹ä¸­ä½¿ç”¨ remote æ¨¡å—æ¥è®¿é—®å®ƒã€‚

è¯¥å·¥å…·é‡‡ç”¨äº†ç¬¬ä¸‰ç§æ–¹å¼çš„ç¬¬ä¸€ç§æƒ…å†µï¼š   
![Multiprocessing][33]  

1ã€ä¸»é¡µé¢æ¸²æŸ“è¿›ç¨‹ A çš„ä»£ç å¦‚ä¸‹ï¼š
```
//â‘ 
ipcRenderer.send('filter-start', {
    filterTagList: this.filterTagList,
	filterWay: this.filterWay,
	curActiveSheetName: this.activeSheet.name
})

// â‘¥ åœ¨æŸå¤„æ¥æ”¶ filter-response äº‹ä»¶
ipcRenderer.on("filter-response", (arg) => {
    // å¾—åˆ°å¤„ç†æ•°æ®
})
```

2ã€ä½œä¸ºä¸­è½¬ç«™çš„ä¸»è¿›ç¨‹çš„ä»£ç å¦‚ä¸‹ï¼š
```
//â‘¡
ipcMain.on("filter-start", (event, arg) => {
    // webContents ç”¨äºæ¸²æŸ“å’Œæ§åˆ¶ web page
    backgroundWindow.webContents.send("filter-start", arg)
})

// â‘¤ ç”¨äºæ¥æ”¶è¿”å›äº‹ä»¶
ipcMain.on("filter-response", (event, arg) => {
    mainWindow.webContents.send("filter-response", arg)
})
```

3ã€å¤„ç†ç¹é‡æ•°æ®çš„ `background process` æ¸²æŸ“è¿›ç¨‹ B çš„ä»£ç å¦‚ä¸‹ï¼š
```
// â‘¢
ipcRenderer.on('filter-start', (event, arg) => {
    // è¿›è¡Œè¿ç®—
    ... 
    
    // â‘£ è¿ç®—å®Œæ¯•åï¼Œå†é€šè¿‡ IPC åŸè·¯è¿”å›ã€‚ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ A ä¹Ÿè¦å»ºç«‹ç›¸åº”çš„ç›‘å¬äº‹ä»¶
    ipcRenderer.send('filter-response', {
        filRow: tempFilRow
    })
})
```

è‡³æ­¤ï¼Œæˆ‘ä»¬å°†ã€è¯»å–æ–‡ä»¶ã€ã€ã€è¿‡æ»¤æ•°æ®ã€å’Œã€å¯¼å‡ºæ–‡ä»¶ã€ä¸‰å¤§è€—æ—¶çš„æ•°æ®æ“ä½œå‡è½¬ç§»åˆ°äº† `background process` ä¸­å¤„ç†ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬åªåˆ›å»ºäº†ä¸€ä¸ª `background process`ï¼Œå¦‚æœæƒ³è¦åšå¾—æ›´æè‡´ï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»ºã€CPU çº¿ç¨‹æ•°- 1 ã€ ä¸ªçš„ `background process` åŒæ—¶å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œç„¶ååœ¨ä¸»è¿›ç¨‹å¯¹å¤„ç†åæ•°æ®è¿›è¡Œæ‹¼æ¥ï¼Œæœ€åå†å°†æ‹¼æ¥åçš„æ•°æ®è¿”å›åˆ°ä¸»é¡µé¢çš„æ¸²æŸ“è¿›ç¨‹ã€‚è¿™æ ·å°±å¯ä»¥å……åˆ†æ¦¨å¹² CPU äº†ã€‚å½“ç„¶ï¼Œåœ¨æ­¤ç¬”è€…ä¸ä¼šè¿›è¡Œè¿™ä¸ªä¼˜åŒ–ã€‚

> ä¸è¦ä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–ï¼Œå¦åˆ™å¾—ä¸å¿å¤±ã€‚ â€”â€” æŸç½‘å‹

### å†…å­˜å æœ‰é‡è¿‡å¤§
è§£å†³äº†æ‰§è¡Œæ•ˆç‡å’Œæ¸²æŸ“é—®é¢˜åï¼Œå‘ç°ä¹Ÿå­˜åœ¨å†…å­˜å ç”¨é‡è¿‡å¤§çš„é—®é¢˜ã€‚å½“æ—¶çŒœæµ‹æ˜¯ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š

1. ä¸‰å¤§è€—æ—¶æ“ä½œå‡æ”¾ç½®åœ¨ `background process` å¤„ç†ã€‚åœ¨é€šè®¯ä¼ é€’æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºä¸æ˜¯å…±äº«å†…å­˜ï¼ˆå› ä¸º IPC æ˜¯åŸºäº Socket çš„ï¼‰ï¼Œå¯¼è‡´å‡ºç°å¤šä»½æ•°æ®å‰¯æœ¬ï¼ˆåœ¨å†™è¿™ç¯‡æ–‡ç« æ—¶æ‰æœ‰äº†è¿™ç›¸å¯¹ç¡®åˆ‡çš„ç­”æ¡ˆï¼‰ã€‚
2. Vuex æ˜¯ä»¥ä¸€ä¸ªå…¨å±€å•ä¾‹çš„æ¨¡å¼è¿›è¡Œç®¡ç†ï¼Œä½†å®ƒä¼šæ˜¯ä¸æ˜¯å¯¹æ•°æ®åšäº†æŸäº›å°è£…ï¼Œè€Œå¯¼è‡´æ€§èƒ½çš„æŸè€—å‘¢ï¼Ÿ
3. ç”±äº JavaScript ç›®å‰ä¸å…·æœ‰ä¸»åŠ¨å›æ”¶èµ„æºçš„èƒ½åŠ›ï¼Œæ‰€ä»¥åªèƒ½ä¸»åŠ¨å¯¹é—²ç½®å¯¹è±¡è®¾ç½®ä¸º `null`ï¼Œç„¶åç­‰å¾… GC å›æ”¶ã€‚

>  ç”±äº Chromium é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼Œå› æ­¤ä¼šæ¶‰åŠåˆ°è¿›ç¨‹é—´é€šä¿¡é—®é¢˜ã€‚Browser è¿›ç¨‹åœ¨å¯åŠ¨ Render è¿›ç¨‹çš„è¿‡ç¨‹ä¸­ä¼šå»ºç«‹ä¸€ä¸ªä»¥ UNIX Socket ä¸ºåŸºç¡€çš„ IPC é€šé“ã€‚æœ‰äº† IPC é€šé“ä¹‹åï¼Œæ¥ä¸‹æ¥ Browser è¿›ç¨‹ä¸ Render è¿›ç¨‹å°±ä»¥æ¶ˆæ¯çš„å½¢å¼è¿›è¡Œé€šä¿¡ã€‚æˆ‘ä»¬å°†è¿™ç§æ¶ˆæ¯ç§°ä¸º IPC æ¶ˆæ¯ï¼Œä»¥åŒºåˆ«äºçº¿ç¨‹æ¶ˆæ¯å¾ªç¯ä¸­çš„æ¶ˆæ¯ã€‚
â€”â€”[ã€ŠChromiumçš„IPCæ¶ˆæ¯å‘é€ã€æ¥æ”¶å’Œåˆ†å‘æœºåˆ¶åˆ†æã€‹][34]


å®šä¹‰ï¼šä¸ºäº†æ˜“äºç†è§£ï¼Œä»¥ä¸‹ã€Excel æ•°æ®ã€å‡æŒ‡ Excel çš„å…¨éƒ¨æœ‰æ•ˆå•å…ƒæ ¼è½¬ä¸º JSON æ ¼å¼åçš„æ•°æ®ã€‚

æœ€å®¹æ˜“å¤„ç†çš„æ— ç–‘æ˜¯ç¬¬ä¸‰ç‚¹ï¼Œæ‰‹åŠ¨å°†ä¸å†éœ€è¦çš„å˜é‡åŠæ—¶è®¾ç½®ä¸º `null`ï¼Œä½†æ•ˆæœå¹¶ä¸æ˜æ˜¾ã€‚

åæ¥ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿçš„ã€æ´»åŠ¨ç›‘è§†å™¨ã€ï¼ˆWindows ä¸Šæ˜¯ä»»åŠ¡ç®¡ç†å™¨ï¼‰å¯¹è¯¥å·¥å…·çš„æ¯é˜¶æ®µï¼ˆæ‰“å¼€æ—¶ã€å¯¼å…¥æ–‡ä»¶æ—¶ã€ç­›é€‰æ—¶å’Œå¯¼å‡ºæ—¶ï¼‰è¿›è¡Œç²—ç•¥çš„å†…å­˜åˆ†æï¼Œå¾—åˆ°ä»¥ä¸‹æŠ¥å‘Šï¼š 

---------------- Sï¼šæŠ¥å‘Šåˆ†å‰²çº¿ ----------------
ç»è§‚å¯Ÿï¼Œä¸»è¦è€—å†…å­˜çš„æ˜¯**é¡µé¢æ¸²æŸ“è¿›ç¨‹**ã€‚ä¸‹é¢é€šè¿‡æˆªå›¾è¯´æ˜ï¼š  
`PID 15243` æ˜¯ä¸»è¿›ç¨‹  
`PID 15246` æ˜¯é¡µé¢æ¸²æŸ“è¿›ç¨‹  
`PID 15248` æ˜¯ background æ¸²æŸ“è¿›ç¨‹  

aã€é¦–æ¬¡å¯åŠ¨ç¨‹åºæ—¶ï¼ˆç¬¬ 4 è¡Œæ˜¯ä¸»è¿›ç¨‹ï¼›ç¬¬ 1 è¡Œæ˜¯é¡µé¢æ¸²æŸ“è¿›ç¨‹ï¼›ç¬¬ 3 è¡Œæ˜¯ background æ¸²æŸ“è¿›ç¨‹ ï¼‰

![å¯åŠ¨ç¨‹åºæ—¶][35]  

bã€å¯¼å…¥æ–‡ä»¶ï¼ˆç¬¬ 5 è¡Œæ˜¯ä¸»è¿›ç¨‹ï¼›ç¬¬ 2 è¡Œæ˜¯é¡µé¢æ¸²æŸ“è¿›ç¨‹ï¼›ç¬¬ 4 è¡Œæ˜¯ background æ¸²æŸ“è¿›ç¨‹ ï¼‰   
![å¯¼å…¥æ–‡ä»¶æ—¶][36]

cã€ç­›é€‰æ•°æ®ï¼ˆç¬¬ 4 è¡Œæ˜¯ä¸»è¿›ç¨‹ï¼›ç¬¬ 1 è¡Œæ˜¯é¡µé¢æ¸²æŸ“è¿›ç¨‹ï¼›ç¬¬ 3 è¡Œæ˜¯ background æ¸²æŸ“è¿›ç¨‹ ï¼‰   
![ç­›é€‰æ•°æ®æ—¶][37]  

ç”±äº JavaScript ç›®å‰ä¸å…·æœ‰ä¸»åŠ¨å›æ”¶èµ„æºçš„åŠŸèƒ½ï¼Œæ‰€ä»¥åªèƒ½ä¸»åŠ¨å°†å¯¹è±¡è®¾ç½®ä¸º `null`ï¼Œç„¶åç­‰å¾… GC å›æ”¶ã€‚

å› æ­¤ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´ç­‰å¾…åï¼Œå†…å­˜å ç”¨å¦‚ä¸‹ï¼š   
dã€ä¸€æ®µæ—¶é—´åï¼ˆç¬¬ 4 è¡Œæ˜¯ä¸»è¿›ç¨‹ï¼›ç¬¬ 1 è¡Œæ˜¯é¡µé¢æ¸²æŸ“è¿›ç¨‹ï¼›ç¬¬ 3 è¡Œæ˜¯ background æ¸²æŸ“è¿›ç¨‹ ï¼‰
![ä¸€æ®µæ—¶é—´å][38]

ç”±ä¸Šè¿°å¯å¾—ï¼Œé¡µé¢æ¸²æŸ“è¿›ç¨‹ç”±äºé¡µé¢å…ƒç´ å’Œ Vue ç­‰ UI ç›¸å…³èµ„æºæ˜¯å›ºå®šçš„ï¼Œå ç”¨å†…å­˜è¾ƒå¤§ä¸”ä¸èƒ½å›æ”¶ã€‚ä¸»è¿›ç¨‹å ç”¨èµ„æºä¹Ÿä¸èƒ½å¾—åˆ°å¾ˆå¥½é‡Šæ”¾ï¼Œæš‚æ—¶ä¸çŸ¥é“åŸå› ï¼Œè€Œ background æ¸²æŸ“è¿›ç¨‹åˆ™è¾ƒå¥½åœ°é‡Šæ”¾èµ„æºã€‚

---------------- Eï¼šæŠ¥å‘Šåˆ†å‰²çº¿ ----------------


æ ¹æ®æŠ¥å‘Šï¼Œåˆæ­¥å¾—å‡ºçš„ç»“è®ºæ˜¯ Vue å’Œé€šè®¯æ—¶å ç”¨èµ„æºè¾ƒå¤§ã€‚

æ ¹æ®è¯¥å·¥å…·çš„å®é™…åº”ç”¨åœºæ™¯ï¼šExcel æ•°æ®åªåœ¨ã€å¯¼å…¥ã€å’Œã€è¿‡æ»¤åã€ä¸¤ä¸ªé˜¶æ®µéœ€è¦å±•ç¤ºï¼Œè€Œä¸”å±•ç¤ºçš„æ˜¯é€šè¿‡ JavaScript æ‹¼æ¥çš„ HTML å­—ç¬¦ä¸²æ‰€æ„æˆçš„ DOM è€Œå·²ã€‚å› æ­¤å°†è¡¨æ ¼æ•°æ®æ”¾ç½®åœ¨ Vuex ä¸­ï¼Œæœ‰ç‚¹æ»¥ç”¨èµ„æºçš„å«Œç–‘ã€‚

å¦å¤–ï¼Œåœ¨ `background process` ä¸­ä¹Ÿæœ‰å­˜æœ‰ä¸€ä»½ Excel æ•°æ®å‰¯æœ¬ã€‚å› æ­¤ï¼Œç´¢æ€§åªåœ¨ `background process` å­˜å‚¨ä¸€ä»½ Excel æ•°æ®ï¼Œç„¶åæ¯å½“æ•°æ®å˜åŒ–æ—¶ï¼Œé€šè¿‡ IPC è®© `background process` è¿”å›æ‹¼æ¥å¥½çš„ HTML å­—ç¬¦ä¸²å³å¯ã€‚è¿™æ ·ä¸€æ¥ï¼Œå†…å­˜å æœ‰é‡ç«‹åˆ»ä¸‹é™è®¸å¤šã€‚å¦å¤–ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸€ä¸¾å¤šå¾—çš„ä¼˜åŒ–ï¼š

1. å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œä¹Ÿè½¬ç§»åˆ°äº† `background process`ï¼Œé¡µé¢æ¸²æŸ“è¿›ç¨‹è¿›ä¸€æ­¥å‡å°‘è€—æ—¶çš„æ“ä½œï¼›
2. å†…å­˜å æœ‰é‡å¤§å¤§å‡å°ï¼Œå“åº”é€Ÿåº¦ä¹Ÿå¾—åˆ°äº†æå‡ã€‚

å…¶å®ï¼Œè¿™ä¹Ÿæœ‰ç‚¹åƒ Vuex çš„ã€å…¨å±€å•ä¾‹æ¨¡å¼ç®¡ç†ã€ï¼Œä¸€ä»½æ•°æ®å°±å¥½ã€‚

å½“ç„¶ï¼Œå¯¹äº Excel çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚è¡Œåˆ—æ•°ã€SheetNameã€æ ‡é¢˜ç»„ç­‰å‡ä¾ç„¶ä¿å­˜åœ¨ Vuexã€‚

ä¼˜åŒ–åçš„å†…å­˜å æœ‰é‡å¦‚ä¸‹å›¾ã€‚ä¸ä¸Šè¿°æŠ¥å‘Šçš„ç¬¬ä¸‰å¼ å›¾ç›¸æ¯”ï¼ˆåŒä¸€é˜¶æ®µï¼‰ï¼Œå†…å­˜å æœ‰é‡ä¸‹é™äº† 44.419%ï¼š
![ä¼˜åŒ–åå†…å­˜å æœ‰é‡][39]    
å¦å¤–ï¼Œå¯¹äºä¸éœ€è¦å“åº”çš„æ•°æ®ï¼Œå¯é€šè¿‡ `Object.freeze()` å†»ç»“èµ·æ¥ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§ä¼˜åŒ–æ‰‹æ®µã€‚ä½†è¯¥å·¥å…·ç›®å‰å¹¶æ²¡æœ‰åº”ç”¨åˆ°ã€‚

è‡³æ­¤ï¼Œä¼˜åŒ–éƒ¨åˆ†ä¹Ÿé˜è¿°å®Œæ¯•äº†ï¼

----------

è¯¥å·¥å…·ç›®å‰æ˜¯å¼€æºçš„ï¼Œæ¬¢è¿å¤§å®¶ä½¿ç”¨æˆ–æ¨èç»™ç”¨ç ”ç»„ç­‰æœ‰éœ€è¦çš„äººã€‚

ä½ ä»¬çš„åé¦ˆï¼ˆå¯æäº¤ [issues][40] / [pull request][41]ï¼‰èƒ½è®©è¿™ä¸ªå·¥å…·åœ¨ä½¿ç”¨å’ŒåŠŸèƒ½ä¸Šä¸æ–­å®Œå–„ã€‚

æœ€åï¼Œæ„Ÿè°¢ [LV][42] åœ¨äº§å“è§„åˆ’ã€ç•Œé¢è®¾è®¡å’Œä¼˜åŒ–ä¸Šçš„å¼ºåŠ›æ”¯æŒã€‚å…¨æ–‡å®Œï¼


  [1]: http://electron.atom.io/
  [2]: http://vuejs.org/
  [3]: https://github.com/SheetJS/js-xlsx
  [4]: //misc.aotu.io/JChehe/2016-11-15-xcel/components.jpg
  [5]: //misc.aotu.io/JChehe/2016-11-15-xcel/main.jpg
  [6]: //misc.aotu.io/JChehe/2016-11-15-xcel/renderer.jpg
  [7]: //misc.aotu.io/JChehe/2016-11-15-xcel/like-this.jpg
  [8]: //misc.aotu.io/JChehe/2016-11-15-xcel/ipc.jpg
  [9]: //misc.aotu.io/JChehe/2016-11-15-xcel/app-files.jpg
  [10]: http://jlord.us/essential-electron/
  [11]: https://segmentfault.com/a/1190000007503495
  [12]: https://github.com/vuejs/vue-migration-helper
  [13]: https://github.com/SheetJS/js-xlsx
  [14]: https://aotu.io/notes/2016/04/07/node-excel/
  [15]: https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign
  [16]: //misc.aotu.io/JChehe/2016-11-15-xcel/fenge.jpg
  [17]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode
  [18]: https://blog.avocode.com/blog/4-must-know-tips-for-building-cross-platform-electron-apps
  [19]: http://electron.atom.io/docs/api/auto-updater/
  [20]: https://github.com/Squirrel
  [21]: https://github.com/Squirrel/Squirrel.Mac
  [22]: https://github.com/Squirrel/Squirrel.Windows
  [23]: https://segmentfault.com/a/1190000007616641
  [24]: http://electron.atom.io/docs/api/download-item/
  [25]: https://nuts.gitbook.com/
  [26]: https://img30.360buyimg.com/ling/jfs/t23491/303/397016798/12152/776e7b40/5b2e3ddbNa8181d28.png
  [27]: //misc.aotu.io/JChehe/2016-11-15-xcel/install-spinner.gif
  [28]: https://github.com/electron/windows-installer/blob/master/resources/install-spinner.gif
  [29]: http://seesawworld.blogspot.com/2016/02/1-nsis.html
  [30]: http://www.infoq.com/cn/articles/vue-2-progressive-front-end-solution
  [31]: https://developer.mozilla.org/en-US/docs/Web/API/Storage
  [32]: https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API
  [33]: //misc.aotu.io/JChehe/2016-11-15-xcel/multiprocess.jpg
  [34]: http://blog.csdn.net/luoshengyang/article/details/47822689
  [35]: https://img20.360buyimg.com/ling/jfs/t22528/169/401386936/20550/9088318e/5b2e3d95N5f402373.png
  [36]: https://img14.360buyimg.com/ling/jfs/t20314/236/1602619966/22609/45b1df6e/5b2e3dabN0676e8d1.png
  [37]: https://img14.360buyimg.com/ling/jfs/t22192/322/1574073289/21531/33f14a3/5b2e3dbaN5a9f3a6d.png
  [38]: https://img10.360buyimg.com/ling/jfs/t21439/62/1600874642/20459/22a0dc08/5b2e3dc5N2a30be1a.png
  [39]: https://img11.360buyimg.com/ling/jfs/t23707/296/382906652/26209/c67155f0/5b2e3dcfN1c2daa62.png
  [40]: https://github.com/o2team/xcel/issues
  [41]: https://github.com/o2team/xcel/pulls
  [42]: https://github.com/mamboer




