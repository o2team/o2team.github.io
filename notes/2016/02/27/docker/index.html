<!DOCTYPE html><html class="theme-lattice"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>初探Docker | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="format-detection" content="telephone=yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="docker hub,部署,环境,docker,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2016/02/27/docker/index.html"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon-48x48.png"><link rel="manifest" href="/img/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#2f83cd"><meta name="application-name" content="Aotu.io"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/img/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/img/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Aotu.io"><meta name="msapplication-TileColor" content="#fff"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-config" content="/img/browserconfig.xml"><meta property="wb:webmaster" content="a1686eb81db284d5"><link rel="dns-prefetch" href="//storage.360buyimg.com"><link rel="dns-prefetch" href="//img10.360buyimg.com"><link rel="dns-prefetch" href="//img11.360buyimg.com"><link rel="dns-prefetch" href="//img12.360buyimg.com"><link rel="dns-prefetch" href="//img13.360buyimg.com"><link rel="dns-prefetch" href="//img14.360buyimg.com"><link rel="dns-prefetch" href="//img20.360buyimg.com"><link rel="dns-prefetch" href="//img30.360buyimg.com"><link rel="dns-prefetch" href="//misc.aotu.io"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="本文旨在让大家了解什么是Docker，并带领大家体验Docker使用的整个流程。"><meta name="keywords" content="docker,环境,部署,docker hub"><meta property="og:type" content="article"><meta property="og:title" content="初探Docker"><meta property="og:url" content="https://aotu.io/notes/2016/02/27/docker/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="本文旨在让大家了解什么是Docker，并带领大家体验Docker使用的整个流程。"><meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://img20.360buyimg.com/ling/jfs/t1/65765/17/2221/97386/5d084e84Eb205d767/098d9e5c2a8a4efa.png"><meta property="og:image" content="https://img11.360buyimg.com/ling/jfs/t1/58010/35/2679/30196/5d084e9dEc28fa2a4/770d10e0b22579ed.png"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/52027/22/2613/74115/5d084eb3Efb56f90e/168c892e8a41747e.png"><meta property="og:image" content="https://img11.360buyimg.com/ling/jfs/t1/55160/7/2751/78506/5d084ec6Ef62fee6c/ea913344f95ab387.png"><meta property="og:updated_time" content="2021-02-02T07:48:05.234Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="初探Docker"><meta name="twitter:description" content="本文旨在让大家了解什么是Docker，并带领大家体验Docker使用的整个流程。"><meta name="twitter:image" content="https://img20.360buyimg.com/ling/jfs/t1/65765/17/2221/97386/5d084e84Eb205d767/098d9e5c2a8a4efa.png"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://geeks.aotu.io" class="main-nav-link">极客沙龙</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="https://img14.360buyimg.com/ling/jfs/t1/71987/5/2223/474252/5d084e65E8e8ff843/d429fe97c9c3cb83.png" alt="初探Docker"></div><header class="post-hd"><h1 class="post-tit">初探Docker</h1><div class="post-meta">by <a target="_blank" href="https://github.com/l-zhi" class="post-author">lizhi</a> on <span>2016-02-27</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>docker：一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器，能够快速部署你的应用</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><p>本文旨在让大家了解什么是Docker，并带领大家体验Docker使用的整个流程。</p><a id="more"></a><p>开启Docker学习之旅前，我们简单描述几个场景，应该很多人都有碰到过：</p><p>小凹同学开发了一个web应用，服务器环境是: <code>centos 7</code> + <code>nginx</code> + <code>node4.6</code> + <code>mongodb3.2.3</code> 最近要上线了。</p><p>【场景1】：刚好公司有一台服务器可以用，但是服务器上有一些其他服务，而且已经装了<code>node3.31</code>和<code>mongodb2.3</code>，小凹蒙了，到底是直接升级环境呢？还是改一个适配低版本的应用呢？</p><p>【场景2】：终于花了很久时间部署上了，慢慢的项目需求越来越多，小凹的同事小凸也准备一起迭代这个项目，小凸又要重新配置一遍应用环境到本地做测试，随着越来越多的同事参与进来，每个人都要配置一遍本地测试环境，重复工作，时间又白白浪费掉。</p><p>【场景3】：随着项目越做越大，现有服务器配置和带宽已经不能满足了，小凹需要把这个项目迁移出去并做水平扩展，然后又得重复配置环境到多台服务器，而且这些服务器有可能还是会重复前面的场景1。</p><p>【场景4】：运维要清理一些服务器，整理出来，把没有完全利用的服务器，分给新的项目用，要罗列出来每台服务器的服务，然后删除掉不需要的，这时候发现完全无从下手。</p><p>上面的场景经常发生，也许就发生在你我身边，而且无比头疼，但对Docker来说解决这些问题都易如反掌，下面我们就一步步来了解并使用Docker。</p><h2 id="什么是Docker？" class="post-heading"><a href="#什么是Docker？" class="headerlink" title="什么是Docker？"></a>什么是Docker？<a class="post-anchor" href="#什么是Docker？" aria-hidden="true"></a></h2><p><a href="https://www.docker.com/" target="_blank" rel="noopener">Docker</a>是一个<a href="https://github.com/docker/docker" target="_blank" rel="noopener">开源</a>的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（<a href="https://zh.wikipedia.org/wiki/%E8%99%9B%E6%93%AC%E6%A9%9F%E5%99%A8" target="_blank" rel="noopener">虚拟机</a>）、<a href="https://en.wikipedia.org/wiki/BareMetal" target="_blank" rel="noopener">bare metal</a>、<a href="https://zh.wikipedia.org/wiki/OpenStack" target="_blank" rel="noopener">OpenStack</a> 集群和其他的基础应用平台。</p><p>官方的描述是：Build, Ship, and Run Any App, Anywhere 在任何地方部署，传输，运行任何应用。</p><p>其实很像虚拟机，但是跟虚拟机比起来 更灵活,速度更快，CPU/内存消耗更低，关键是更方便管理。</p><p><img src="https://img20.360buyimg.com/ling/jfs/t1/65765/17/2221/97386/5d084e84Eb205d767/098d9e5c2a8a4efa.png" alt="img"></p><p>上图就是一张Docker层级图， 最下面是核心系统，文件系统等构成Dokcer底层，上面的是镜像（image），分为基础镜像和普通镜像，所有镜像可以直接启动生成一个实例（container），container我们可以理解为一个可以直接运行的虚拟机了。</p><p>其中基础image 启动后生成container，然后添加一些应用如 <code>apache</code>，<code>emacs</code>，可以通过提交操作直接生成普通的image。 我们可以共享这个image到任何地方，并启动它。</p><h2 id="使用Docker" class="post-heading"><a href="#使用Docker" class="headerlink" title="使用Docker"></a>使用Docker<a class="post-anchor" href="#使用Docker" aria-hidden="true"></a></h2><h3 id="1-安装" class="post-heading"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装<a class="post-anchor" href="#1-安装" aria-hidden="true"></a></h3><p>Docker 可以安装在 <code>Linux</code>, <code>Mac OS</code>, <code>Windows</code> 上，详细安装步骤可以参考 <strong><a href="https://docs.docker.com/engine/installation/" target="_blank" rel="noopener">官方安装文档</a></strong> 。</p><p><em>注：本文就不一一举例所有的安装方法，就以操作系统 <strong><a href="https://zh.wikipedia.org/wiki/CentOS" target="_blank" rel="noopener">centos</a></strong> 为例。</em></p><p>由于docker 只支持 <code>centos6</code>以上，<code>64</code>位的版本操作系统，所以安装前可以用以下命令查看服务器系统。<br></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ getconf LONG_BIT           <span class="comment">//查看操作系统是多少位</span></span><br><span class="line">&gt; <span class="number">64</span></span><br><span class="line">$ cat /etc/redhat-release    <span class="comment">//查看操作系统版本</span></span><br><span class="line">&gt; CentOS Linux release <span class="number">7.0</span><span class="number">.1406</span> (Core)</span><br></pre></td></tr></table></figure><p></p><p>上面是我使用的机器 <code>centos7</code> <code>64</code>位系统，我就以这个为例讲下面的使用步骤。<br></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -fsSL <span class="keyword">https</span>://<span class="built_in">get</span>.docker.com/ | sh<span class="comment"> //安装</span></span><br><span class="line">$ docker <span class="built_in">version</span><span class="comment"> // 查看是否安装成功</span></span><br></pre></td></tr></table></figure><p></p><p>如果 <strong>安装失败</strong> 可以尝试使用阿里云的代理安装。<br></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -sSL http://acs-public-mirror.oss-<span class="keyword">cn</span>-hangzhou.aliyuncs.<span class="keyword">com</span>/docker-engine/internet | <span class="keyword">sh</span> -</span><br></pre></td></tr></table></figure><p></p><p>其他更详细的阿里云Docker代理加速器文档，可以点击<a href="https://help.aliyun.com/knowledge_detail/5974865.html" target="_blank" rel="noopener">这里</a></p><p>安装成功后启动Docker，并设置开机启动。<br></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> sudo service docker start  <span class="comment">//开启Docker 服务</span></span><br><span class="line"><span class="symbol">$</span> sudo chkconfig docker on   <span class="comment">//开机启动</span></span><br></pre></td></tr></table></figure><p></p><h3 id="获取基础镜像" class="post-heading"><a href="#获取基础镜像" class="headerlink" title="获取基础镜像"></a>获取基础镜像<a class="post-anchor" href="#获取基础镜像" aria-hidden="true"></a></h3><p><em>注：假定我需要部署一个基于<code>centos</code>的应用，当然也可以换成别的，比如：<code>Redis</code> 或者 <code>Ubuntu</code>，可以是任何镜像来当做基础镜像，跟本机原有系统无关，只与所要部署的应用有关。</em></p><p>首先搜索需要获取的 <strong><a href="https://hub.docker.com/explore/" target="_blank" rel="noopener">镜像</a></strong>，这是官方<code>Docker Hub</code>提供的镜像资源。</p><p>比如，我选择获取 <strong><a href="https://hub.docker.com/_/centos/" target="_blank" rel="noopener">centos最新版本</a></strong></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$</span> docker pull centos <span class="comment">//获取centos最近版本的镜像</span></span><br></pre></td></tr></table></figure><p><img src="https://img11.360buyimg.com/ling/jfs/t1/58010/35/2679/30196/5d084e9dEc28fa2a4/770d10e0b22579ed.png" alt="img"><br>使用命令 <code>docker images</code> 就能查到刚才获取的 <code>centos</code> 的镜像，如上图。</p><h3 id="配置新的镜像" class="post-heading"><a href="#配置新的镜像" class="headerlink" title="配置新的镜像"></a>配置新的镜像<a class="post-anchor" href="#配置新的镜像" aria-hidden="true"></a></h3><p><em>注：为了方便演示，假定我们的服务只需要安装一个<code>zip</code>的<code>centos</code>系统。</em></p><p>将上面获取的 <code>centos</code> 镜像，启动生成container，并在container中安装zip。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@AY130809220512304015Z <span class="built_in">image</span>]<span class="meta"># docker run -t -i centos /bin/bash</span></span><br></pre></td></tr></table></figure><p><code>docker run</code> 启动容器，<code>-t</code>:为容器重新分配一个伪输入终端，通常与 -i 同时使用； <code>-i</code>:以交互模式运行容器，通常与 -t 同时使用；<code>centos</code> 为镜像名， 镜像名通常以 <strong>镜像名:版本</strong> 来使用，因为centos没有版本所以省略, 后面 <code>/bin/bash</code> 是启动container后运行的程序。<br></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>e44ea4258885 /]# zip  <span class="comment">//先运行zip，发现是没有安装的</span></span><br><span class="line">bash: zip: command <span class="keyword">not</span> found</span><br><span class="line">[<span class="symbol">root@</span><span class="number">90934</span>d1f4225 /]# yum install zip  <span class="comment">//安装zip</span></span><br><span class="line">[<span class="symbol">root@</span><span class="number">90934</span>d1f4225 /]# zip <span class="comment">//查看zip，安装成功</span></span><br><span class="line">Copyright (c) <span class="number">1990</span><span class="number">-2008</span> Info-ZIP - Type <span class="string">'zip "-L"'</span> <span class="keyword">for</span> software license.</span><br><span class="line">Zip <span class="number">3.0</span> (July <span class="number">5</span>th <span class="number">2008</span>). Usage:</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p></p><p>使用container命令行安装<code>zip</code>成功。<br></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span><span class="number">90934</span>d1f4225 /]# exit</span><br></pre></td></tr></table></figure><p></p><p>退出容器命令行，因为不是后台运行，所以退出后，container也随即关闭了。<code>-d</code> 可以让container在后台运行，并可以随时通过<code>docker attach</code> 命令进入容器，具体例子可以看<a href="https://docs.docker.com/engine/reference/commandline/attach/" target="_blank" rel="noopener">这里</a>,因为不是本文重点就不展开说明了。</p><p><code>docker ps</code> 命令可以查看当前启动的 container， <code>-a</code> 启动和没启动的都会展示。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>AY130809220512304015Z image]# docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES</span><br><span class="line"><span class="number">8f</span>08b2b67380        centos              <span class="string">"/bin/bash"</span>         <span class="number">21</span> minutes ago      Exited (<span class="number">0</span>) <span class="number">20</span> minutes ago                       lonely_euler</span><br></pre></td></tr></table></figure><p>有一个id为 8f08b2b67380的container，这个就是我们刚才安装了zip，并退出的container。<br></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>AY130809220512304015Z image]# docker commit -m <span class="string">"Added zip install"</span> <span class="number">8f</span>08b2b67380 test:<span class="number">1</span></span><br><span class="line">sha256:<span class="number">8f</span>1d192a4ea2a80801e33cd5fadb5f37180bb718f729f77a404a347b977d753c</span><br></pre></td></tr></table></figure><p></p><p><code>docker commit</code> 将container提交生成image， <code>-m</code>：为描述, 后面紧接着的是container的id， <code>test:1</code> 是提交的镜像名称和版本。</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@AY130809220512304015Z image]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line"><span class="keyword">test                 </span>1                   8f1d192a4ea2        About a minute ago   266.7 MB</span><br><span class="line">centos              latest              0f0be3675ebb        7 days ago           196.6 MB</span><br></pre></td></tr></table></figure><p>再查看的时候已经多了一个image了，这个image就是我们安装了zip的image，到此我们已经生成一个新的image。</p><p>我们可以直接通过这个新的镜像启动容器，还是前面介绍过的命令<code>docker run</code> 并测试下zip，如下：<br></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@AY130809220512304015Z image]# sudo docker <span class="builtin-name">run</span> -t -i test:1 /bin/bash</span><br><span class="line">[root@2f1f28be351c /]# zip</span><br><span class="line">Copyright (c) 1990-2008 Info-ZIP -<span class="built_in"> Type </span><span class="string">'zip "-L"'</span> <span class="keyword">for</span> software license.</span><br><span class="line">Zip 3.0 (July 5th 2008). Usage:</span><br><span class="line"><span class="built_in">..</span>.</span><br></pre></td></tr></table></figure><p></p><p>好了这个镜像已经制作完成，当然实际情况下，安装的肯定不仅仅只有zip这么简单。</p><p>但是在一个团队里，仅仅给我们image，我们可能不知道这个镜像到底做了什么，所以还有一种方法使用 配置文件<code>Dockerfile</code>，build出来一个镜像，这样更易于团队协作,下面我将介绍一下这种方式。</p><h3 id="通过Dockerfile-配置新的image" class="post-heading"><a href="#通过Dockerfile-配置新的image" class="headerlink" title="通过Dockerfile 配置新的image"></a>通过Dockerfile 配置新的image<a class="post-anchor" href="#通过Dockerfile-配置新的image" aria-hidden="true"></a></h3><p>开始之前顺便介绍删除image和container的命令，它们分别是<code>docker rmi</code> 删除image 和 <code>docker rm</code> 删除container，后面都是跟对应的id或者名称，为了后面的操作我们这里通过命令 <code>docker rmi 8f1d192a4ea2</code> 删除掉刚才建的image。</p><p><em>注：如果发现删不掉image，可能被某些容器引用了，可以通过上面介绍的<code>docker ps -a</code>查看container，并用 <code>docker rm</code>删除掉这个container</em>。</p><p>接着我们创建<code>Dockerfile</code><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mkdir o2team</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> o2team</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> touch Dockerfile</span></span><br></pre></td></tr></table></figure><p></p><p>下面是 <code>Dockerfile</code> 中的内容<br></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dockerfile for o2team</span></span><br><span class="line"><span class="comment"># http://aotu.io/</span></span><br><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"><span class="keyword">MAINTAINER</span> lizhi &lt;fanlizhi@jd.com&gt;</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install zip</span></span><br></pre></td></tr></table></figure><p></p><p><code>#</code>为注释，<code>FROM centos</code> 为基础镜像来源，<code>MAINTAINER</code>为作者信息, <code>RUN</code> 则为 运行某些 命令，编辑完成后保存，然后我们就可以直接构建我们新的image，Dockerfile详细使用文档可以参看<a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener">这里</a>。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">root@</span>AY130809220512304015Z o2team-test]# docker build -t test:<span class="number">1</span> .</span><br></pre></td></tr></table></figure><p><code>docker build</code>就是通过Dockfile来创建一个新的Image，其中 <code>-t</code>:为新image的名字这里命名为test:1， <code>&quot;.&quot;</code> 则会在当前的目录下找 <code>Dockerfile</code> 文件,当然这里也可以指定路径。</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@AY130809220512304015Z o2team-test]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line"><span class="keyword">test                </span>1                   8975f3fb142e        8 seconds ago       266.7 MB</span><br><span class="line">centos              latest              0f0be3675ebb        9 days ago          196.6 MB</span><br></pre></td></tr></table></figure><p>就这样，通过<code>docker images</code>也能生成一个新的镜像了，这种用Dockerfile的方式更加适合团队使用，环境配置更清晰。</p><p>到这里，我们只需要管理我们的镜像就好了，比如同步镜像给其他人，或者其他机器。</p><p>其实docker就给我们提供了这样一整套的解决方案，我们可以把我们的镜像提交到 <strong><a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a></strong>，类似 <code>github</code>一样的远程仓库，当我们需要的时候只需要 pull下来启动就好了。</p><h3 id="提交" class="post-heading"><a href="#提交" class="headerlink" title="提交"></a>提交<a class="post-anchor" href="#提交" aria-hidden="true"></a></h3><p>我们就把这个test镜像提交到<code>Docker Hub</code></p><p>首先我们得先注册：<a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p><p>注册成功后就可以<code>docker login</code>登录了<br></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@AY130809220512304015Z</span> o2team-test]<span class="meta"># docker login</span></span><br><span class="line">&gt; Username: a569171010</span><br><span class="line">&gt; Password: xxx</span><br><span class="line">&gt; Email: fanlizhi<span class="symbol">@jd</span>.com</span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure><p></p><p>填完登录后就可以push了，注意这里push之前得确保名称是 <code>youruser/xxx</code><br>比如我的用户名是 a569171010 所以我需要将刚才的image 重命名成 a569171010/test:1,这里可以用<code>docker tag</code>命令重命名。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@AY130809220512304015Z o2team-<span class="keyword">test</span>]# docker tag <span class="keyword">test</span>:<span class="number">1</span> a569171010/<span class="keyword">test</span>:<span class="number">1</span></span><br><span class="line">[root@AY130809220512304015Z o2team-<span class="keyword">test</span>]# docker <span class="keyword">push</span> a569171010/<span class="keyword">test</span>:<span class="number">1</span></span><br></pre></td></tr></table></figure><p>然后就发布出去了，在 <strong><a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a></strong> 上就可以看到下面多了这一条记录，当我们要获取的时候就直接 <code>docker pull a569171010/test</code>就可以了，因为是公用库所以任何人都可以获取并使用。<br><img src="https://img14.360buyimg.com/ling/jfs/t1/52027/22/2613/74115/5d084eb3Efb56f90e/168c892e8a41747e.png" alt="img"></p><p>我们已经基本熟悉，了解了整个Docker使用的流程，回过头来看看开始我们抛出的那几个曾经很棘手的问题，是不是都能迎刃而解呢？因为image的可移植和隔离性，我们不仅可以轻松迁移扩展，还能轻松了解现在机器上各个服务运行情况。</p><p>下图为Docker整个使用流程：<br><img src="https://img11.360buyimg.com/ling/jfs/t1/55160/7/2751/78506/5d084ec6Ef62fee6c/ea913344f95ab387.png" alt="img"></p><h3 id="本文参考资料" class="post-heading"><a href="#本文参考资料" class="headerlink" title="本文参考资料"></a>本文参考资料<a class="post-anchor" href="#本文参考资料" aria-hidden="true"></a></h3><p><a href="https://www.docker.com/" target="_blank" rel="noopener">Docker 官方文档</a><br><a href="http://www.widuu.com/docker/index.html" target="_blank" rel="noopener">Docker 中文指南</a><br><a href="http://dockone.io/article/101" target="_blank" rel="noopener">dockone.io 国内比较活跃的Docker论坛</a><br><a href="http://tech.meituan.com/docker_introduction.html" target="_blank" rel="noopener">Docker 入门介绍</a><br><a href="https://github.com/docker/docker-registry" target="_blank" rel="noopener">Docker github</a><br><a href="https://help.aliyun.com/knowledge_detail/5974865.html" target="_blank" rel="noopener">阿里镜像使用文档</a><br><a href="https://zh.wikipedia.org/zh/Docker_(%E8%BB%9F%E9%AB%94" target="_blank" rel="noopener">维基百科</a></p><h3 id="还想了解的" class="post-heading"><a href="#还想了解的" class="headerlink" title="还想了解的"></a>还想了解的<a class="post-anchor" href="#还想了解的" aria-hidden="true"></a></h3><p>这篇文章只是带领大家了解Docker的整个使用流程和体验，关于其他的一些细节问题比如：后台运行container，各container之间的通讯，端口映射，文件共享等都没有涉及到,最近<code>docker1.1.0</code>发布又有很多新的特性和性能优化，如果有兴趣的同学可以参考这些：</p><p><a href="http://tech.uc.cn/?p=2726" target="_blank" rel="noopener">利用Docker构建开发环境</a><br><a href="https://www.gitbook.com/book/yeasy/docker_practice/details" target="_blank" rel="noopener">Docker-从入门到实践</a><br><a href="https://github.com/veggiemonk/awesome-docker" target="_blank" rel="noopener">Docker-学习资料</a><br><a href="https://blog.docker.com/2016/02/docker-1-10/" target="_blank" rel="noopener">Docker 1.1.0新特性</a></p><div class="post-tags" style="display:none"><a href="/tags/docker/">docker</a> <a href="/tags/环境/">环境</a> <a href="/tags/部署/">部署</a> <a href="/tags/docker-hub/">docker hub</a></div><div class="post-categories" style="display:none"><a href="/cates/Web开发/">Web开发</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2016/02/27/docker/">https://aotu.io/notes/2016/02/27/docker/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2021-02-02T07:48:05.234Z">上次更新：2021-02-02 15:48:05</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2016/03/01/createjs-get-started/" title="createjs开发入门">createjs开发入门 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2016/02/26/use-npm-script-instead-of-gulp/" title="使用npm scripts替代gulp"><i class="fa fa-chevron-left"></i> 使用npm scripts替代gulp</a></div></div><div class="post-comments" id="comments"></div><script>var gitalkOpts={id:"bm90ZXMvMjAxNi8wMi8yNy9kb2NrZXIv",owner:"o2team",repo:"o2team.github.io",title:"初探Docker",body:"https://aotu.io/notes/2016/02/27/docker/index.html\n\ndocker：一个开源的引擎，可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器，能够快速部署你的应用",clientID:"3c4d153e6874260f9c7e",clientSecret:"dd44012504c6168bc05b9266e0554bb28c62ce15",admin:["l-zhi"]}</script></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//taro.jd.com" target="_blank" title="Taro">Taro</a></li><li><a href="//taro-ui.jd.com" target="_blank" title="Taro-UI">Taro-UI</a></li><li><a href="//taro-ext.jd.com" target="_blank" title="Taro 物料市场">Taro 物料市场</a></li><li><a href="//taro-club.jd.com" target="_blank" title="Taro 官方论坛">Taro 官方论坛</a></li><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li><li><a href="//aotu.jd.com/share/" target="_blank" title="凹凸公开课">凹凸公开课</a></li><li><a href="//at.aotu.io" target="_blank" title="AT-UI">AT-UI</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://www.cloudbase.net" target="_blank" title="小程序·云开发"><img style="width:22px;vertical-align:middle" src="https://img20.360buyimg.com/ling/jfs/t1/57175/5/15617/50216/5dca6729E00cdff5d/631622525425290e.png">小程序·云开发</a></li><li><a href="https://ling.jd.com" target="_blank" title="京东羚珑智能设计">羚珑智能设计</a></li><li><a href="https://jdrd.jd.com" target="_blank" title="京东零售设计服务平台">京东零售设计服务平台</a></li><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://dopro.io/" target="_blank" title="腾讯 Deep Ocean">Deep Ocean</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li><li><a href="https://uiiiuiii.com/" target="_blank" title="优优教程网">优优教程网</a></li><li><a href="https://www.designup.cn/" target="_blank" title="Designup">Designup</a></li><li><a href="http://eux.baidu.com/" target="_blank" title="百度EUX">百度EUX</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2021. All Rights Reserved.</p><p><a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/post_wx_share.js"></script><script src="/js/bundle/gitalk.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript" src="https://tajs.qq.com/stats?sId=53685723" charset="UTF-8"></script></body></html>