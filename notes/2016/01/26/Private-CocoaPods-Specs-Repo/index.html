<!DOCTYPE html><html class="theme-lattice"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><title>如何创建私有 CocoaPods 仓库 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="format-detection" content="telephone=yes"><meta name="robots" content="index, follow"><meta baidu-gxt-verify-token="2b74a5aea155a215abea8547f929190c"><meta name="keywords" content="Swift,CocoaPods,iOS,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2016/01/26/Private-CocoaPods-Specs-Repo/index.html"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon-48x48.png"><link rel="manifest" href="/img/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#2f83cd"><meta name="application-name" content="Aotu.io"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/img/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/img/apple-touch-icon-1024x1024.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Aotu.io"><meta name="msapplication-TileColor" content="#fff"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-config" content="/img/browserconfig.xml"><meta property="wb:webmaster" content="a1686eb81db284d5"><link rel="dns-prefetch" href="//storage.360buyimg.com"><link rel="dns-prefetch" href="//img10.360buyimg.com"><link rel="dns-prefetch" href="//img11.360buyimg.com"><link rel="dns-prefetch" href="//img12.360buyimg.com"><link rel="dns-prefetch" href="//img13.360buyimg.com"><link rel="dns-prefetch" href="//img14.360buyimg.com"><link rel="dns-prefetch" href="//img20.360buyimg.com"><link rel="dns-prefetch" href="//img30.360buyimg.com"><link rel="dns-prefetch" href="//misc.aotu.io"><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="公共 CocoaPods打开隐藏目录，可以使用命令:  1234//打开隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool true//关闭隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool false 接着需要重启一下 Finder， 可以按住 opti"><meta name="keywords" content="iOS,CocoaPods,Swift"><meta property="og:type" content="article"><meta property="og:title" content="如何创建私有 CocoaPods 仓库"><meta property="og:url" content="https://aotu.io/notes/2016/01/26/Private-CocoaPods-Specs-Repo/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="公共 CocoaPods打开隐藏目录，可以使用命令:  1234//打开隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool true//关闭隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool false 接着需要重启一下 Finder， 可以按住 opti"><meta property="og:locale" content="zh-cn"><meta property="og:image" content="https://img30.360buyimg.com/ling/jfs/t1/67516/3/2179/61753/5d077588E47f4fc10/757f64a2a7356744.jpg"><meta property="og:image" content="https://img12.360buyimg.com/ling/jfs/t1/52974/27/2681/84579/5d0775a1E9e81406e/cbcc9897b4bb94ab.jpg"><meta property="og:image" content="https://img13.360buyimg.com/ling/jfs/t1/68531/10/2201/74765/5d0775bbE8f665cc3/76a7049f6fe2404d.jpg"><meta property="og:image" content="https://img30.360buyimg.com/ling/jfs/t1/65897/31/2151/79243/5d0775d7E786f2ccc/4086959a87e76a08.jpg"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/44057/16/6884/70609/5d0775f2E8cab78dc/90317f7dfdcbb7df.jpg"><meta property="og:image" content="https://img13.360buyimg.com/ling/jfs/t1/83381/12/2184/107454/5d07760eEb012ea37/877034c31af0f8b3.jpg"><meta property="og:image" content="https://img12.360buyimg.com/ling/jfs/t1/52322/19/2676/176226/5d077625E0ef41224/6cc6d6f428ba9b1a.jpg"><meta property="og:image" content="https://img14.360buyimg.com/ling/jfs/t1/47522/9/2625/159794/5d077641E39d75522/7a68584936cd539c.jpg"><meta property="og:updated_time" content="2021-02-02T07:48:05.234Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="如何创建私有 CocoaPods 仓库"><meta name="twitter:description" content="公共 CocoaPods打开隐藏目录，可以使用命令:  1234//打开隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool true//关闭隐藏的命令:defaults write com.apple.finder AppleShowAllFiles -bool false 接着需要重启一下 Finder， 可以按住 opti"><meta name="twitter:image" content="https://img30.360buyimg.com/ling/jfs/t1/67516/3/2179/61753/5d077588E47f4fc10/757f64a2a7356744.jpg"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a target="_blank" href="https://geeks.aotu.io" class="main-nav-link">极客沙龙</a></li><li class="main-nav-item"><a href="https://cases.aotu.io" class="main-nav-link">H5案例</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search" id="J_search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main typo"><article class="post"><div class="post-cover"><img src="//img11.360buyimg.com/ling/jfs/t1/56047/33/2676/74520/5d07756cEfac0d4c6/381bd1ebdeac83f7.png" alt="如何创建私有 CocoaPods 仓库"></div><header class="post-hd"><h1 class="post-tit">如何创建私有 CocoaPods 仓库</h1><div class="post-meta">by <a target="_blank" href="https://github.com/marklin2012" class="post-author">MarkLin</a> on <span>2016-01-26</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>本文介绍如何创建私有的 CocoaPods 仓库</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-content"><h3 id="公共-CocoaPods" class="post-heading"><a href="#公共-CocoaPods" class="headerlink" title="公共 CocoaPods"></a>公共 CocoaPods<a class="post-anchor" href="#公共-CocoaPods" aria-hidden="true"></a></h3><p>打开隐藏目录，可以使用命令:</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//打开隐藏的命令:</span></span><br><span class="line">defaults <span class="built_in">write</span> com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">//关闭隐藏的命令:</span></span><br><span class="line">defaults <span class="built_in">write</span> com.apple.finder AppleShowAllFiles -<span class="keyword">bool</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>接着需要重启一下 <strong>Finder</strong>， 可以按住 <strong>option</strong> + 右键 <strong>Finder</strong> 图标选择重启。然后打开隐藏目录 <strong>.cocoapods</strong> (这个目录在你的个人目录底下, <code>~/.cocoapods</code> 或 <code>/Users/[username]/.cocoapods</code>)</p><a id="more"></a><p><img src="//img30.360buyimg.com/ling/jfs/t1/67516/3/2179/61753/5d077588E47f4fc10/757f64a2a7356744.jpg" alt="repo"></p><p>可以看到上图， <strong>.cocoapods</strong> 目录下的 <strong>repos</strong> 其实是 <strong>repository</strong> （仓库）的缩写。 <strong>repos</strong> 中存放的时仓库的集合。这里的 <strong>master</strong> 就是 <strong>CocoaPods</strong> 官方建立的仓库，也就是我们所谓的公共库。</p><p><strong>specs</strong> 目录下存放的就是所有提交到 <strong>CocoaPods</strong> 的开源库的 <strong>podspec</strong> 文件的集合。<br>其结构如下图所示：</p><p><img src="//img12.360buyimg.com/ling/jfs/t1/52974/27/2681/84579/5d0775a1E9e81406e/cbcc9897b4bb94ab.jpg" alt="repo"></p><p>其组成方式：</p><p>specName – version – specName.podspec</p><p>( <strong>master</strong> 里现在是 <strong>specName.podspec.json</strong>，这个 <strong>.json</strong> 文件就是 <strong>podspec</strong> 文件加了个后缀。我们可以采用 <code>pod ipc spec</code> 这个命令来将 <strong>spec</strong> 文件转换成 <strong>.json</strong>)</p><p>那这个文件夹是如何来得呢？其实，这个文件夹是在你安装了 <strong>CocoaPods</strong> 后，第一次执行 <code>pod install</code> 时， <strong>CocoaPods</strong> 通过命令 <code>pod setup</code> 来建立的（这条命令会自动执行）。</p><blockquote><p>上述是官方的 <strong>repo</strong> ，私有库的话可以看下我们前面的翻译或者查看<a href="https://guides.cocoapods.org/making/private-cocoapods.html" target="_blank" rel="noopener">官方文档</a>，但是官方文档有一些过程写的不是特别详细，自己实现的时候遇到了一些坑，特此梳理一下过程，按照官方文档内容实现一个私有的 <strong>spec repo</strong> 。根据官方的原理，我们只需要创建一个和 <strong>master</strong> 相类似结构的目录就可以实现私有的 <strong>spec repo</strong>，当然你可以 <strong>fork</strong> 一个官方的 <strong>repo</strong>，但是它包含了太多没有必要地库在里面，这在编译仓库的时候需要浪费大量的时间，所以我们只要自己重新创建一个就可以了。</p></blockquote><h3 id="1-创建一个私有的-Spec-Repo" class="post-heading"><a href="#1-创建一个私有的-Spec-Repo" class="headerlink" title="1.创建一个私有的 Spec Repo"></a>1.创建一个私有的 <strong>Spec Repo</strong><a class="post-anchor" href="#1-创建一个私有的-Spec-Repo" aria-hidden="true"></a></h3><p>在你的 git 服务器上创建一个 <strong>repo</strong>。这里你可以在 <strong>github</strong> 或者你自己的 git 服务器上实现。公司内部使用的话这里推荐大家使用私有的仓库,但是 <strong>github</strong> 的私有仓库是要收费的 <strong>$7/month</strong> （壕请无视 - -！）。大部分公司都是有自己的git服务器，不过一般只能在公司内网使用，或者可以选择<a href="https://gitlab.com" target="_blank" rel="noopener">Gitlab</a>,<a href="https://coding.net" target="_blank" rel="noopener">Coding</a>, <a href="https://bitbucket.org/" target="_blank" rel="noopener">Bitbucket</a>任意一种。我们以在 <strong>github</strong> 上创建为例：</p><p><img src="//img13.360buyimg.com/ling/jfs/t1/68531/10/2201/74765/5d0775bbE8f665cc3/76a7049f6fe2404d.jpg" alt="repo"></p><p>如图所示，我们在 <strong>github</strong> 上创建一个空的仓库，命名为 <strong>O2Specs</strong> ，这个仓库是用来存放我们自己所有的私有库的 <strong>spec</strong> 文件，就如同官方的 <a href="https://github.com/CocoaPods/Specs" target="_blank" rel="noopener"><strong>https://github.com/CocoaPods/Specs</strong></a> 是用来存放所有官方的 <strong>specs</strong> 文件一样。</p><p>然后我们就可以执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo add REPO_NAME SOURCE_URL</span><br></pre></td></tr></table></figure><p>其中的 REPO_NAME 是我们要添加的私有 <strong>repo</strong> 的名称（这里我们待会填的是: <strong>O2Specs</strong>），后面是仓库的 git 地址。这里做的其实是创建的工作，也就是在 <code>~/.cocoapods/repo</code> 目录下添加了一个以你的私有 <strong>repo</strong> 为名的文件夹，但是并没有添加 <strong>spec</strong> 文件。</p><p>在终端执行命令：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo add O2Specs https://github.com/marklin2012/O2Specs.git</span><br></pre></td></tr></table></figure><p></p><p>这里用的是 <strong>https</strong> 地址，当然你也可以用 <strong>git</strong> 地址，不过这样有可能失败。如果失败，很大因素是你 <strong>github</strong> 的 <strong>ssh</strong> 在本地没有配置好，配置方法可以看这里：<a href="https://help.github.com/articles/generating-ssh-keys/" target="_blank" rel="noopener"><strong>Generating SSH keys</strong></a>，成功后可以看得到 <strong>.cocoapods</strong> 目录如下图所示：</p><p><img src="//img30.360buyimg.com/ling/jfs/t1/65897/31/2151/79243/5d0775d7E786f2ccc/4086959a87e76a08.jpg" alt="repo"></p><p>至此，我们已经在本地得到我们自己的私有仓库 <strong>O2Specs</strong> ，这是一个空的仓库。</p><h3 id="2-添加私有的-Repo-安装到你的-CocoaPods-中" class="post-heading"><a href="#2-添加私有的-Repo-安装到你的-CocoaPods-中" class="headerlink" title="2.添加私有的 Repo 安装到你的 CocoaPods 中"></a>2.添加私有的 <strong>Repo</strong> 安装到你的 <strong>CocoaPods</strong> 中<a class="post-anchor" href="#2-添加私有的-Repo-安装到你的-CocoaPods-中" aria-hidden="true"></a></h3><p>这个步骤需要我们事先完成 <strong>CocoaPods</strong> 依赖库的搭建，具体可以查看我们另外一篇教程：<a href="http://www.jianshu.com/p/7a82e977281c" target="_blank" rel="noopener">制作 <strong>CocoaPods</strong> 依赖库</a>。如果这里你想先看看效果，也可以直接从 <strong>github</strong> 上 clone <a href="https://github.com/marklin2012/O2View" target="_blank" rel="noopener">示例工程</a>继续下面的操作。</p><p>让我们进入到上面 clone 的示例工程目录中（或者你自己搭建的依赖库目录中）：</p><p><img src="//img14.360buyimg.com/ling/jfs/t1/44057/16/6884/70609/5d0775f2E8cab78dc/90317f7dfdcbb7df.jpg" alt="repo"></p><p>打开工程的 <strong>podspec</strong> 文件：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Pod::Spec.new <span class="keyword">do</span> <span class="params">|s|</span></span><br><span class="line">  s.name         = <span class="string">"O2View"</span>				<span class="comment">#名称</span></span><br><span class="line">  s.version      = <span class="string">"0.0.1"</span>				<span class="comment">#版本号</span></span><br><span class="line">  s.summary      = <span class="string">"Just testing"</span>		<span class="comment">#简短介绍</span></span><br><span class="line">  s.description  = &lt;&lt;-DESC</span><br><span class="line">  					私有Pods测试</span><br><span class="line">  					* Markdown 格式</span><br><span class="line">                   DESC</span><br><span class="line"></span><br><span class="line">  s.homepage     = <span class="string">"http://aotu.io/"</span></span><br><span class="line">  <span class="comment"># s.screenshots  = "www.example.com/screenshots_1.gif"</span></span><br><span class="line">  s.license      = <span class="string">"MIT"</span>				<span class="comment">#开源协议</span></span><br><span class="line">  s.author             = &#123; <span class="string">"linyi31"</span> =&gt; <span class="string">"linyi@jd.com"</span> &#125;</span><br><span class="line"></span><br><span class="line">  s.source       = &#123; <span class="symbol">:git</span> =&gt; <span class="string">"https://github.com/marklin2012/O2View.git"</span> &#125;</span><br><span class="line">  <span class="comment">## 这里不支持ssh的地址，只支持HTTP和HTTPS，最好使用HTTPS</span></span><br><span class="line">  <span class="comment">## 正常情况下我们会使用稳定的tag版本来访问，如果是在开发测试的时候，不需要发布release版本，直接指向git地址使用</span></span><br><span class="line">  <span class="comment">## 待测试通过完成后我们再发布指定release版本，使用如下方式</span></span><br><span class="line">  <span class="comment">#s.source       = &#123; :git =&gt; "http://EXAMPLE/O2View.git", :tag =&gt; s.version &#125;</span></span><br><span class="line">  </span><br><span class="line">  s.platform     = <span class="symbol">:ios</span>, <span class="string">"9.0"</span>			<span class="comment">#支持的平台及版本，这里我们呢用swift，直接上9.0</span></span><br><span class="line">  s.requires_arc = <span class="literal">true</span>					<span class="comment">#是否使用ARC</span></span><br><span class="line"></span><br><span class="line">  s.source_files  = <span class="string">"O2View/*.swift"</span>	<span class="comment">#OC可以使用类似这样"Classes/**/*.&#123;h,m&#125;"</span></span><br><span class="line"></span><br><span class="line">  s.frameworks = <span class="string">'UIKit'</span>, <span class="string">'QuartzCore'</span>, <span class="string">'Foundation'</span>	<span class="comment">#所需的framework,多个用逗号隔开</span></span><br><span class="line">  s.module_name = <span class="string">'O2View'</span>				<span class="comment">#模块名称</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># s.dependency "JSONKit", "~&gt; 1.4"	#依赖关系，该项目所依赖的其他库，如果有多个可以写多个 s.dependency</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这个文件本质上是一个 <strong>ruby</strong> 文件，这是我们事先已经实现好的依赖库的 <strong>podspec</strong> 文件，如果前面步骤都正常的话，也就是说我们认为这个 <strong>podspec</strong> 是合法的话，就可以直接将这些内容 <strong>push</strong> 到我们本地的 <strong>repo</strong> 中。为了避免错误，我们可以再验证一下，命令行输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint</span><br></pre></td></tr></table></figure><p>运行之后可能会得到下面的警告：</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> -&gt; O2View (<span class="number">0.0</span><span class="number">.1</span>)</span><br><span class="line">    - WARN  | source: Git sources should specify a tag.</span><br><span class="line"></span><br><span class="line">[!] O2View did not pass validation, due <span class="keyword">to</span> <span class="number">1</span> warning (but you can <span class="keyword">use</span> `--allow-warnings` <span class="keyword">to</span> ignore it) <span class="keyword">and</span> All results apply only <span class="keyword">to</span> <span class="keyword">public</span> specs, but you can <span class="keyword">use</span> `--<span class="keyword">private</span>` <span class="keyword">to</span> ignore them <span class="keyword">if</span> linting the specification <span class="keyword">for</span> a <span class="keyword">private</span> pod..</span><br><span class="line">You can <span class="keyword">use</span> the `--no-clean` option <span class="keyword">to</span> inspect any issue.</span><br></pre></td></tr></table></figure><p>由于我们的示例工程还没有生成正式的 <strong>release</strong> 版本， <strong>github</strong> 上并没有任何 <strong>tag</strong>，所以我们刚才填写 <strong>.podspec</strong> 文件填写 <strong>git</strong> 地址的时候没有填写指定 <strong>tag</strong> （上面文件的注释中有提到），解决方法我们可以先执行忽略警告的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod lib lint --allow-warnings</span><br></pre></td></tr></table></figure><p>如果成功会出现如下输出：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> -&gt; O2View (<span class="number">0.0</span><span class="number">.1</span>)</span><br><span class="line">    - WARN  | source: Git sources should specify a tag.</span><br><span class="line"></span><br><span class="line">O2View passed validation.</span><br></pre></td></tr></table></figure><p>到此，我们的 <strong>O2View.podspec</strong> 就符合规范了。</p><h3 id="3-添加你的-Podspec-到你的-repo" class="post-heading"><a href="#3-添加你的-Podspec-到你的-repo" class="headerlink" title="3.添加你的 Podspec 到你的 repo"></a>3.添加你的 <strong>Podspec</strong> 到你的 <strong>repo</strong><a class="post-anchor" href="#3-添加你的-Podspec-到你的-repo" aria-hidden="true"></a></h3><p>在前面验证通过的基础上，我们接着执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod repo push O2Specs O2View.podspec</span><br></pre></td></tr></table></figure><p>执行完，如果失败会有相对应的警告和错误提示，只要按照警告和错误的详细信息进行修改和完善即可。成功的情况应该可以在终端看到类似的输出：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Validating <span class="keyword">spec</span></span><br><span class="line"> -&gt; O2View (<span class="number">0.0</span>.<span class="number">1</span>)</span><br><span class="line">    - WARN  | source: Git sources should specify a <span class="keyword">tag</span>.</span><br><span class="line"></span><br><span class="line">Updating the `O2Specs' repo</span><br><span class="line"></span><br><span class="line">Already up-to-<span class="keyword">date</span>.</span><br><span class="line"></span><br><span class="line">Adding the <span class="keyword">spec</span> to the `O2Specs' repo</span><br><span class="line"></span><br><span class="line"> - [Add] O2View (<span class="number">0.0</span>.<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">Pushing the `O2Specs' repo</span><br><span class="line"></span><br><span class="line">To https://github.com/marklin2012/O2Specs.git</span><br><span class="line">   <span class="number">9</span>f32092..<span class="number">8</span>d0ced5  <span class="keyword">master</span> <span class="title">-&gt; master</span></span><br></pre></td></tr></table></figure><p>再进入到 <strong>.cocoapods</strong> 的目录中，可以看到已经发生了变化：</p><p><img src="//img13.360buyimg.com/ling/jfs/t1/83381/12/2184/107454/5d07760eEb012ea37/877034c31af0f8b3.jpg" alt="repo"></p><p>同时，我们还发现 <strong>O2Specs</strong> 的 <strong>github</strong> 仓库也已经发生了变化：</p><p><img src="//img12.360buyimg.com/ling/jfs/t1/52322/19/2676/176226/5d077625E0ef41224/6cc6d6f428ba9b1a.jpg" alt="repo"></p><p>按照平时使用 <strong>CocoaPods</strong> 的习惯，我们添加依赖库之前会先搜索一下库，让我们执行一下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod search O2View</span><br></pre></td></tr></table></figure><p>哈哈，可以看到已经建立成功了！</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-&gt; O2View (<span class="number">0.0</span><span class="number">.1</span>)</span><br><span class="line">   Just testing</span><br><span class="line">   pod <span class="string">'O2View'</span>, <span class="string">'~&gt; 0.0.1'</span></span><br><span class="line">   - <span class="string">Homepage:</span> <span class="string">http:</span><span class="comment">//aotu.io/</span></span><br><span class="line">   - <span class="string">Source:</span>   <span class="string">https:</span><span class="comment">//github.com/marklin2012/O2View.git</span></span><br><span class="line">   - <span class="string">Versions:</span> <span class="number">0.0</span><span class="number">.1</span> [O2Specs repo]</span><br></pre></td></tr></table></figure><h3 id="4-测试私有-pod" class="post-heading"><a href="#4-测试私有-pod" class="headerlink" title="4.测试私有 pod"></a>4.测试私有 pod<a class="post-anchor" href="#4-测试私有-pod" aria-hidden="true"></a></h3><p>看到前面的搜索结果，小伙伴们是不是开始有点激动了？让我们建立一个普通的工程，命名为 <strong>TestPodDemo</strong>，然后在终端 <strong>cd</strong> 到其目录路径下，添加一个 <strong>Podfile</strong> 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod init</span><br></pre></td></tr></table></figure><p>建立后修改 <strong>Podfile</strong> 文件内容如下：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use_frameworks!</span><br><span class="line"></span><br><span class="line">target <span class="symbol">'TestPodDemo</span>' <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">pod ‘O2View’</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod install</span><br></pre></td></tr></table></figure><p>我们得到如下提示：</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Updating local specs repositories</span><br><span class="line">Analyzing dependencies</span><br><span class="line">[<span class="comment">!] Unable to find a specification for `O2View`</span></span><br><span class="line"></span><br><span class="line">[<span class="comment">!] Your Podfile has had smart quotes sanitised. To avoid issues in the future, you should not use TextEdit for editing it. If you are not using TextEdit, you should turn off smart quotes in your editor of choice.</span></span><br></pre></td></tr></table></figure><p>找不到 <strong>O2View</strong> ？ 额- -！。。。刚才 <strong>search</strong> 明明可以找到这个依赖库的，为什么现在找不到了呢？</p><p>别着急!其实原因是你在 <strong>Podfile</strong> 中没有指定路径，当你执行 <code>pod install</code> 的时候，<strong>CocoaPods</strong> 默认只会在 <strong>master</strong> 下搜索，而我们的 <strong>spec</strong> 是存在我们私有的 <strong>O2Specs</strong> 目录下的。所以解决方式很简单，就是引入搜索地址即可，在 <strong>Podfile</strong> 的顶部添加如下两行代码：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source <span class="string">'https://github.com/CocoaPods/Specs.git'</span>		<span class="comment">#官方仓库地址</span></span><br><span class="line">source ‘https:<span class="regexp">//gi</span>thub.com<span class="regexp">/marklin2012/</span>O2Specs.git’		<span class="comment">#私有仓库地址</span></span><br></pre></td></tr></table></figure><p>这里必须添加两个地址，默认情况下，你如果不添加 <strong>source</strong> ，系统会默认使用官方仓库地址，但是当你添加了 <strong>source</strong> 之后，系统就不会自动搜索官方地址，所以这两句都必须添加，否则其他基于官方的依赖库都不能使用了。</p><p>再次执行 <code>pod install</code> ，我们就可以看到很顺利的安装成功了：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Updating local specs repositories</span><br><span class="line">Analyzing dependencies</span><br><span class="line">Downloading dependencies</span><br><span class="line">Using O2View (0.0.1)</span><br><span class="line">Generating Pods project</span><br><span class="line">Integrating<span class="built_in"> client </span>project</span><br><span class="line">Sending stats</span><br><span class="line">Pod installation complete! There is 1 dependency <span class="keyword">from</span> the Podfile <span class="keyword">and</span> 1 total pod installed.</span><br></pre></td></tr></table></figure><p>恭喜！这样一来我们就可以使用这个私有库了！</p><h3 id="发布稳定的依赖库版本" class="post-heading"><a href="#发布稳定的依赖库版本" class="headerlink" title="发布稳定的依赖库版本"></a>发布稳定的依赖库版本<a class="post-anchor" href="#发布稳定的依赖库版本" aria-hidden="true"></a></h3><p>前面我们提到过，我们的这个实例依赖库 <strong>O2View</strong> 没有生成稳定的 <strong>release</strong> 版本。当我们调试完内容之后，一般都是要发布稳定版本的，更新之后再继续发布新版本。我们可以使用命令行或者在 <strong>github</strong> 页面手动生成，这里为了方便我们使用命令行，首先在终端中 <strong>cd</strong> 到之前的依赖库 <strong>O2View</strong> 的目录中，然后输入如下命令：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">tag</span> <span class="title">'0</span>.<span class="number">0.1</span>'</span><br><span class="line">git push --tags</span><br><span class="line">git push origin <span class="literal">master</span></span><br></pre></td></tr></table></figure><p>这样我们就得到了一个稳定的 <strong>release</strong> 版本 <strong>0.0.1</strong>：</p><p><img src="//img14.360buyimg.com/ling/jfs/t1/47522/9/2625/159794/5d077641E39d75522/7a68584936cd539c.jpg" alt="repo"></p><blockquote><p>这里我用的版本号是 <strong>0.0.1</strong> 基于研发版本，关于版本号的一些规范可以参考：<a href="http://semver.org/lang/zh-CN/" target="_blank" rel="noopener">语义化版本 2.0.0</a></p></blockquote><p>对于我们的 <strong>podspec</strong> 文件，我们也需要将 <code>s.source</code> 做一下小小的改动:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.source       = &#123; :<span class="function"><span class="params">git</span> =&gt;</span> <span class="string">"https://github.com/marklin2012/O2View.git"</span>, :<span class="function"><span class="params">tag</span> =&gt;</span> version &#125;</span><br></pre></td></tr></table></figure><p>这样我们使用这个依赖库的时候就能对应上版本号，并且知道在 <strong>github</strong> 中使用稳定的 <strong>release</strong> 版本代码。太棒了！</p><p>最后只需要再重复 <code>push</code> 一下我们的 <strong>Podfile</strong> 就可以！</p><h3 id="接下来做什么？" class="post-heading"><a href="#接下来做什么？" class="headerlink" title="接下来做什么？"></a>接下来做什么？<a class="post-anchor" href="#接下来做什么？" aria-hidden="true"></a></h3><p>好了，到这里我们已经完全掌握如何创建一个本地私有的 <strong>CocoaPods</strong> 了！我们完全可以把我们项目中得代码拆出来封装成一些 <strong>pods</strong>， 好好使用这个黑魔法！</p><p>祝大家玩得愉快！</p><div class="post-tags" style="display:none"><a href="/tags/iOS/">iOS</a> <a href="/tags/CocoaPods/">CocoaPods</a> <a href="/tags/Swift/">Swift</a></div><div class="post-categories" style="display:none"><a href="/cates/移动开发/">移动开发</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2016/01/26/Private-CocoaPods-Specs-Repo/">https://aotu.io/notes/2016/01/26/Private-CocoaPods-Specs-Repo/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2021-02-02T07:48:05.234Z">上次更新：2021-02-02 15:48:05</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2016/01/27/how-to-make-cocoapods/" title="如何制作cocoaPods依赖库">如何制作cocoaPods依赖库 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2016/01/16/UFT/" title="UFT 需求提报平台回顾"><i class="fa fa-chevron-left"></i> UFT 需求提报平台回顾</a></div></div><div class="post-comments" id="comments"></div><script>var gitalkOpts={id:"bm90ZXMvMjAxNi8wMS8yNi9Qcml2YXRlLUNvY29hUG9kcy1TcG",owner:"o2team",repo:"o2team.github.io",title:"如何创建私有 CocoaPods 仓库",body:"https://aotu.io/notes/2016/01/26/Private-CocoaPods-Specs-Repo/index.html\n\n本文介绍如何创建私有的 CocoaPods 仓库",clientID:"3c4d153e6874260f9c7e",clientSecret:"dd44012504c6168bc05b9266e0554bb28c62ce15",admin:["marklin2012"]}</script></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//taro.jd.com" target="_blank" title="Taro">Taro</a></li><li><a href="//taro-ui.jd.com" target="_blank" title="Taro-UI">Taro-UI</a></li><li><a href="//taro-ext.jd.com" target="_blank" title="Taro 物料市场">Taro 物料市场</a></li><li><a href="//taro-club.jd.com" target="_blank" title="Taro 官方论坛">Taro 官方论坛</a></li><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li><li><a href="//xcel.aotu.io" target="_blank" title="Excel Filter">Excel Filter</a></li><li><a href="//aotu.jd.com/share/" target="_blank" title="凹凸公开课">凹凸公开课</a></li><li><a href="//at.aotu.io" target="_blank" title="AT-UI">AT-UI</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://www.cloudbase.net" target="_blank" title="小程序·云开发"><img style="width:22px;vertical-align:middle" src="https://img20.360buyimg.com/ling/jfs/t1/57175/5/15617/50216/5dca6729E00cdff5d/631622525425290e.png">小程序·云开发</a></li><li><a href="https://ling.jd.com" target="_blank" title="京东羚珑智能设计">羚珑智能设计</a></li><li><a href="https://jdrd.jd.com" target="_blank" title="京东零售设计服务平台">京东零售设计服务平台</a></li><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://dopro.io/" target="_blank" title="腾讯 Deep Ocean">Deep Ocean</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li><li><a href="https://uiiiuiii.com/" target="_blank" title="优优教程网">优优教程网</a></li><li><a href="https://www.designup.cn/" target="_blank" title="Designup">Designup</a></li><li><a href="http://eux.baidu.com/" target="_blank" title="百度EUX">百度EUX</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2021. All Rights Reserved.</p><p><a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="/js/post_wx_share.js"></script><script src="/js/bundle/gitalk.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript" src="https://tajs.qq.com/stats?sId=53685723" charset="UTF-8"></script></body></html>